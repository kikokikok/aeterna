apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: aeterna-memory-vs
  namespace: aeterna
spec:
  hosts:
    - aeterna-memory
  http:
    - name: default
      route:
        - destination:
            host: aeterna-memory
            port:
              number: 8081
      retries:
        attempts: 3
        perTryTimeout: 10s
        retryOn: gateway-error,connect-failure,retriable-4xx,reset
      timeout: 30s
---
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: aeterna-knowledge-vs
  namespace: aeterna
spec:
  hosts:
    - aeterna-knowledge
  http:
    - name: default
      route:
        - destination:
            host: aeterna-knowledge
            port:
              number: 8082
      retries:
        attempts: 3
        perTryTimeout: 10s
        retryOn: gateway-error,connect-failure,retriable-4xx,reset
      timeout: 30s
---
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: aeterna-governance-vs
  namespace: aeterna
spec:
  hosts:
    - aeterna-governance
  http:
    - name: default
      route:
        - destination:
            host: aeterna-governance
            port:
              number: 8083
      retries:
        attempts: 3
        perTryTimeout: 5s
        retryOn: gateway-error,connect-failure,retriable-4xx,reset
      timeout: 15s
---
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: aeterna-sync-vs
  namespace: aeterna
spec:
  hosts:
    - aeterna-sync
  http:
    - name: default
      route:
        - destination:
            host: aeterna-sync
            port:
              number: 8084
      retries:
        attempts: 3
        perTryTimeout: 5s
        retryOn: gateway-error,connect-failure,retriable-4xx,reset
      timeout: 15s
