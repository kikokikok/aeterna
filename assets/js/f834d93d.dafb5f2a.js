"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[6532],{9804(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"helm/quickstart-hybrid","title":"Hybrid Mode Deployment Guide","description":"Overview","source":"@site/docs/helm/quickstart-hybrid.md","sourceDirName":"helm","slug":"/helm/quickstart-hybrid","permalink":"/aeterna/docs/helm/quickstart-hybrid","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/helm/quickstart-hybrid.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Local Mode Quick Start","permalink":"/aeterna/docs/helm/quickstart-local"},"next":{"title":"Remote Mode Deployment Guide","permalink":"/aeterna/docs/helm/quickstart-remote"}}');var l=r(4848),i=r(8453);const a={},s="Hybrid Mode Deployment Guide",c={},o=[{value:"Overview",id:"overview",level:2},{value:"When to Use Hybrid Mode",id:"when-to-use-hybrid-mode",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Configure Central Server Access",id:"step-1-configure-central-server-access",level:2},{value:"Step 2: Install Aeterna in Hybrid Mode",id:"step-2-install-aeterna-in-hybrid-mode",level:2},{value:"Step 3: Verify Sync",id:"step-3-verify-sync",level:2},{value:"Step 4: Configure Local Cache",id:"step-4-configure-local-cache",level:2},{value:"Step 5: Verify Cedar Agent (Local Policy)",id:"step-5-verify-cedar-agent-local-policy",level:2},{value:"Key Configuration",id:"key-configuration",level:2},{value:"Sync Configuration",id:"sync-configuration",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"hybrid-mode-deployment-guide",children:"Hybrid Mode Deployment Guide"})}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"Hybrid mode combines a local cache and policy engine with a remote central Aeterna server. The local deployment handles policy evaluation and fast data access while the central server manages long term persistence and shared knowledge. This setup works well for multi cluster environments or edge locations that need local performance but centralized data control."}),"\n",(0,l.jsx)(n.h2,{id:"when-to-use-hybrid-mode",children:"When to Use Hybrid Mode"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Multiple clusters that must share the same underlying data."}),"\n",(0,l.jsx)(n.li,{children:"Edge or branch deployments with intermittent connectivity to the main site."}),"\n",(0,l.jsx)(n.li,{children:"Scenarios requiring local policy evaluation to keep authorization latency low."}),"\n",(0,l.jsx)(n.li,{children:"Organizations that want local caching paired with a central source of truth."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,l.jsx)(n.p,{children:"This diagram shows how the local hybrid instance interacts with the central server."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[Local Cluster]                    [Central Cluster]\nAeterna (hybrid) \u2500\u2500sync\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Aeterna (central)\n\u251c\u2500\u2500 Dragonfly (cache)              \u251c\u2500\u2500 PostgreSQL\n\u251c\u2500\u2500 Qdrant (vector cache)          \u251c\u2500\u2500 Qdrant\n\u251c\u2500\u2500 Cedar Agent (local policy)     \u251c\u2500\u2500 OPAL Server\n\u2514\u2500\u2500 OPAL Fetcher (disabled)        \u2514\u2500\u2500 Full stack\n"})}),"\n",(0,l.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"A central Aeterna server that is already deployed and reachable."}),"\n",(0,l.jsx)(n.li,{children:"Valid API keys or OAuth2 credentials for the central instance."}),"\n",(0,l.jsx)(n.li,{children:"Kubernetes version 1.25 or higher."}),"\n",(0,l.jsx)(n.li,{children:"Helm version 3.10 or higher."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"step-1-configure-central-server-access",children:"Step 1: Configure Central Server Access"}),"\n",(0,l.jsx)(n.p,{children:"The local instance needs to authenticate with the central server. Create a Kubernetes secret to store your API key or credentials safely."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl create secret generic aeterna-central-auth \\\n  --from-literal=api-key=YOUR_CENTRAL_API_KEY\n"})}),"\n",(0,l.jsx)(n.h2,{id:"step-2-install-aeterna-in-hybrid-mode",children:"Step 2: Install Aeterna in Hybrid Mode"}),"\n",(0,l.jsx)(n.p,{children:"Use the provided hybrid configuration to install the chart. Point the installation to your central server URL and reference the secret you created."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"helm install aeterna aeterna/aeterna -f examples/values-hybrid.yaml \\\n  --set central.url=https://aeterna-central.example.com \\\n  --set central.existingSecret=aeterna-central-auth\n"})}),"\n",(0,l.jsx)(n.h2,{id:"step-3-verify-sync",children:"Step 3: Verify Sync"}),"\n",(0,l.jsx)(n.p,{children:"Check the logs of the Aeterna pod to ensure the memory synchronization is active. You should see entries confirming that the local cache is pulling updates from the central server."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl logs -l app.kubernetes.io/name=aeterna -c aeterna\n"})}),"\n",(0,l.jsx)(n.p,{children:'Look for messages about "sync successful" or "memory layer updated" to confirm connectivity.'}),"\n",(0,l.jsx)(n.h2,{id:"step-4-configure-local-cache",children:"Step 4: Configure Local Cache"}),"\n",(0,l.jsx)(n.p,{children:"In hybrid mode, Aeterna uses Dragonfly and Qdrant as local caches. Dragonfly stores frequently accessed metadata while Qdrant keeps a local copy of vector embeddings. This allows the system to perform complex searches and policy checks without hitting the central database every time. The local instance automatically manages cache expiration based on the sync interval."}),"\n",(0,l.jsx)(n.h2,{id:"step-5-verify-cedar-agent-local-policy",children:"Step 5: Verify Cedar Agent (Local Policy)"}),"\n",(0,l.jsx)(n.p,{children:"Hybrid mode enables the Cedar Agent locally while disabling the OPAL Fetcher. This means policies are evaluated on the local cluster using data from the local cache. Verify the agent status by checking its sidecar container."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl logs -l app.kubernetes.io/name=aeterna -c cedar-agent\n"})}),"\n",(0,l.jsx)(n.p,{children:"The logs will show policy evaluation requests being handled locally."}),"\n",(0,l.jsx)(n.h2,{id:"key-configuration",children:"Key Configuration"}),"\n",(0,l.jsxs)(n.p,{children:["Most hybrid settings live in ",(0,l.jsx)(n.code,{children:"examples/values-hybrid.yaml"}),". Key values include:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"deploymentMode: hybrid"}),": Activates the hybrid logic."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"central.url"}),": The endpoint for the remote central server."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"central.auth"}),": Authentication details for the remote connection."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"postgresql.bundled: false"}),": Disables the local database since data lives centrally."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opal.cedarAgent.enabled: true"}),": Ensures local policy evaluation."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"opal.fetcher.enabled: false"}),": Prevents the local instance from trying to fetch data updates directly from Git or other sources."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"sync-configuration",children:"Sync Configuration"}),"\n",(0,l.jsx)(n.p,{children:"The synchronization behavior depends on these specific settings:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sync.interval"}),": Controls how often the local cache polls the central server for changes."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sync.batchSize"}),": Determines how many records are synchronized in a single request."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sync.memoryLayers"}),": Defines which data types are cached locally versus what stays remote."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Adjust these values to balance local performance against network usage."}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Central server unreachable"}),": Verify the network path and check if the ",(0,l.jsx)(n.code,{children:"central.url"})," is correct. Ensure any load balancers or firewalls allow traffic between clusters."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Sync failures"}),": Check the API key in your secret. Look for authentication errors in the Aeterna logs."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Stale policies"}),": If local evaluations don't match the central server, shorten the ",(0,l.jsx)(n.code,{children:"sync.interval"})," or manually trigger a sync if supported."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>a,x:()=>s});var t=r(6540);const l={},i=t.createContext(l);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);