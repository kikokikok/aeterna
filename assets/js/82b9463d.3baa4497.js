"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[4681],{3695(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"specs/knowledge-provider-spec","title":"Knowledge Provider Specification","description":"Purpose","source":"@site/docs/specs/knowledge-provider-spec.md","sourceDirName":"specs","slug":"/specs/knowledge-provider-spec","permalink":"/aeterna/docs/specs/knowledge-provider-spec","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/specs/knowledge-provider-spec.md","tags":[],"version":"current","frontMatter":{}}');var i=r(4848),t=r(8453);const d={},l="Knowledge Provider Specification",c={},o=[{value:"Purpose",id:"purpose",level:2},{value:"Goals",id:"goals",level:3},{value:"Requirements",id:"requirements",level:2},{value:"Requirement: Knowledge Provider Interface",id:"requirement-knowledge-provider-interface",level:3},{value:"Scenario: Provider initialization",id:"scenario-provider-initialization",level:4},{value:"Requirement: Core Concepts",id:"requirement-core-concepts",level:3},{value:"Scenario: Knowledge provider initialization",id:"scenario-knowledge-provider-initialization",level:4},{value:"Knowledge Entry",id:"knowledge-entry",level:3},{value:"Knowledge Source",id:"knowledge-source",level:3},{value:"Access Policy",id:"access-policy",level:3},{value:"Requirement: Knowledge Entry Model",id:"requirement-knowledge-entry-model",level:3},{value:"Scenario: Create knowledge entry",id:"scenario-create-knowledge-entry",level:4},{value:"Requirement: Memory Layer Architecture",id:"requirement-memory-layer-architecture",level:3},{value:"Scenario: Cross-layer query with ranking",id:"scenario-cross-layer-query-with-ranking",level:4},{value:"Layer Types",id:"layer-types",level:3},{value:"Layer Characteristics",id:"layer-characteristics",level:3},{value:"Cross-Layer Queries",id:"cross-layer-queries",level:3},{value:"Scenario: Cross-layer query with ranking",id:"scenario-cross-layer-query-with-ranking-1",level:4},{value:"OpenSpec Protocol Specification",id:"openspec-protocol-specification",level:2},{value:"Requirement: Discovery Endpoint",id:"requirement-discovery-endpoint",level:3},{value:"Requirement: Query Endpoint",id:"requirement-query-endpoint",level:3},{value:"Scenario: Semantic search query",id:"scenario-semantic-search-query",level:4},{value:"Scenario: Cross-layer query",id:"scenario-cross-layer-query",level:4},{value:"Requirement: Create/Update Endpoint",id:"requirement-createupdate-endpoint",level:3},{value:"Scenario: Create entry with auto-embedding",id:"scenario-create-entry-with-auto-embedding",level:4},{value:"Requirement: Delete Endpoint",id:"requirement-delete-endpoint",level:3},{value:"Requirement: Batch Operations Endpoint",id:"requirement-batch-operations-endpoint",level:3},{value:"Requirement: Streaming Endpoint",id:"requirement-streaming-endpoint",level:3},{value:"Scenario: Stream knowledge updates",id:"scenario-stream-knowledge-updates",level:4},{value:"Requirement: Metadata Operations Endpoint",id:"requirement-metadata-operations-endpoint",level:3},{value:"Security &amp; Authentication",id:"security--authentication",level:2},{value:"Authentication Methods",id:"authentication-methods",level:3},{value:"Bearer Token Authentication",id:"bearer-token-authentication",level:4},{value:"Authorization",id:"authorization",level:4},{value:"Security Headers",id:"security-headers",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Error Codes",id:"error-codes",level:3},{value:"Performance Requirements",id:"performance-requirements",level:2},{value:"Latency Targets",id:"latency-targets",level:3},{value:"Throughput Targets",id:"throughput-targets",level:3},{value:"Testing Requirements",id:"testing-requirements",level:2},{value:"Test Coverage",id:"test-coverage",level:3},{value:"Testability",id:"testability",level:3},{value:"Property-Based Testing",id:"property-based-testing",level:3},{value:"Mutation Testing",id:"mutation-testing",level:3},{value:"OpenAPI Specification",id:"openapi-specification",level:2},{value:"Compliance Checklist",id:"compliance-checklist",level:2}];function a(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"knowledge-provider-specification",children:"Knowledge Provider Specification"})}),"\n",(0,i.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,i.jsxs)(n.p,{children:["OpenSpec defines a ",(0,i.jsx)(n.strong,{children:"universal protocol for Knowledge Providers"})," that enables AI agents, tools, and applications to seamlessly query, store, and retrieve knowledge from pluggable backend systems."]}),"\n",(0,i.jsx)(n.h3,{id:"goals",children:"Goals"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Universal Compatibility"}),": Any OpenCode-compliant agent can use any OpenSpec provider"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pluggable Architecture"}),": Easy to add/remove knowledge sources"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type Safety"}),": Strong typing for all operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Performance"}),": Efficient query and retrieval with minimal overhead"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extensibility"}),": Rich capabilities for diverse knowledge sources"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsx)(n.h3,{id:"requirement-knowledge-provider-interface",children:"Requirement: Knowledge Provider Interface"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide a backend that stores knowledge, supports queries, manages metadata, and exposes OpenSpec-compliant endpoints."}),"\n",(0,i.jsx)(n.h4,{id:"scenario-provider-initialization",children:"Scenario: Provider initialization"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"WHEN"})," a knowledge provider is initialized\n",(0,i.jsx)(n.strong,{children:"THEN"})," the provider MUST be ready to accept knowledge entries\n",(0,i.jsx)(n.strong,{children:"AND"})," the provider MUST expose discovery endpoint for capability enumeration\n",(0,i.jsx)(n.strong,{children:"AND"})," the provider MUST support all required OpenSpec operations"]}),"\n",(0,i.jsx)(n.h3,{id:"requirement-core-concepts",children:"Requirement: Core Concepts"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL implement core knowledge provider concepts including knowledge entry model, source tracking, and access policies."}),"\n",(0,i.jsx)(n.h4,{id:"scenario-knowledge-provider-initialization",children:"Scenario: Knowledge provider initialization"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"WHEN"})," a knowledge provider is initialized\n",(0,i.jsx)(n.strong,{children:"THEN"})," the provider SHALL support storing knowledge entries\n",(0,i.jsx)(n.strong,{children:"AND"})," SHALL support querying knowledge with semantic or structured search\n",(0,i.jsx)(n.strong,{children:"AND"})," SHALL manage metadata, access policies, and versioning\n",(0,i.jsx)(n.strong,{children:"AND"})," SHALL expose a standardized OpenSpec API"]}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"Knowledge Provider"})," is a backend system that:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stores"})," knowledge documents, facts, and embeddings"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Queries"})," knowledge using semantic search or structured queries"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Manages"})," metadata, access policies, and versioning"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Exposes"})," a standardized OpenSpec API"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"knowledge-entry",children:"Knowledge Entry"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface KnowledgeEntry {\n  id: string;                    // Unique identifier\n  content: string;                // Raw content (text, code, document)\n  embedding?: number[];          // Vector representation (optional for some providers)\n  metadata: KnowledgeMetadata;   // Structured metadata\n  source: KnowledgeSource;        // Where knowledge came from\n  access_policy: AccessPolicy;   // Who can access this entry\n  created_at: ISO8601;          // Creation timestamp\n  updated_at?: ISO8601;         // Last modification\n  version?: number;              // Version number (for versioned knowledge)\n}\n\ninterface KnowledgeMetadata {\n  title?: string;\n  description?: string;\n  tags?: string[];\n  language?: string;\n  author?: string;\n  confidence?: number;            // 0.0-1.0 confidence score\n  importance?: number;           // 0.0-1.0 importance score\n  custom?: Record<string, any>;  // Provider-specific metadata\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"knowledge-source",children:"Knowledge Source"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'enum KnowledgeSourceType {\n  "user_upload",              // User uploaded documents\n  "git_repository",         // Git repository\n  "notebooklm",            // NotebookLM source\n  "dust_ai",                // Dust.tt AI\n  "perplexity",             // Perplexity AI\n  "web_scrape",             // Web-scraped content\n  "api_import",              // Imported from API\n  "agent_generated",         // Generated by AI agent\n  "custom_provider"          // Custom knowledge provider\n}\n\ninterface KnowledgeSource {\n  type: KnowledgeSourceType;\n  identifier: string;          // URL, repo name, etc.\n  version?: string;            // Git commit hash, API version, etc.\n  provider_id?: string;       // Which knowledge provider\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"access-policy",children:"Access Policy"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'enum AccessPolicy {\n  "private",          // Only creator can access\n  "restricted",       // Creator + approved users\n  "shared",          // Team/group can access\n  "organization",    // Anyone in organization\n  "public",          // Anyone (with auth)\n}\n\ninterface AccessPolicyConfig {\n  policy: AccessPolicy;\n  approved_users?: string[];     // For "restricted"\n  allowed_teams?: string[];      // For "shared"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"requirement-knowledge-entry-model",children:"Requirement: Knowledge Entry Model"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL implement a KnowledgeEntry model with metadata, embeddings, source tracking, and access policies."}),"\n",(0,i.jsx)(n.h4,{id:"scenario-create-knowledge-entry",children:"Scenario: Create knowledge entry"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WHEN"})," a client creates a knowledge entry with content and metadata"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"THEN"})," the system SHALL generate a unique identifier"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," SHALL store content, metadata, and source information"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," SHALL optionally generate vector embeddings"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," SHALL apply the specified access policy"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"requirement-memory-layer-architecture",children:"Requirement: Memory Layer Architecture"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL support a multi-layered memory hierarchy for optimal performance and data organization."}),"\n",(0,i.jsx)(n.h4,{id:"scenario-cross-layer-query-with-ranking",children:"Scenario: Cross-layer query with ranking"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WHEN"})," a query is submitted with multiple layer types specified"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"THEN"})," all specified layers are queried concurrently"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," results are aggregated and ranked by relevance score"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," total execution time includes all layer query times"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," metadata reports which layers contributed results"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"layer-types",children:"Layer Types"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Layer Type"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Storage"}),(0,i.jsx)(n.th,{children:"Performance"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"working"})}),(0,i.jsx)(n.td,{children:"Temporary context (conversation state)"}),(0,i.jsx)(n.td,{children:"In-memory"}),(0,i.jsx)(n.td,{children:"~\xb5s latency"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"session"})}),(0,i.jsx)(n.td,{children:"Session-specific data"}),(0,i.jsx)(n.td,{children:"Cache with TTL"}),(0,i.jsx)(n.td,{children:"~ms latency"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"episodic"})}),(0,i.jsx)(n.td,{children:"Agent experiences/events"}),(0,i.jsx)(n.td,{children:"Structured DB"}),(0,i.jsx)(n.td,{children:"~10-50ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"semantic"})}),(0,i.jsx)(n.td,{children:"Vector embeddings"}),(0,i.jsx)(n.td,{children:"Vector DB"}),(0,i.jsx)(n.td,{children:"~20-100ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"procedural"})}),(0,i.jsx)(n.td,{children:"Facts and rules"}),(0,i.jsx)(n.td,{children:"Structured DB"}),(0,i.jsx)(n.td,{children:"~10-30ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"user"})}),(0,i.jsx)(n.td,{children:"User personal memory"}),(0,i.jsx)(n.td,{children:"Structured DB + vectors"}),(0,i.jsx)(n.td,{children:"~20-50ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"organization"})}),(0,i.jsx)(n.td,{children:"Shared organizational knowledge"}),(0,i.jsx)(n.td,{children:"Structured DB + vectors"}),(0,i.jsx)(n.td,{children:"~50-200ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"archival"})}),(0,i.jsx)(n.td,{children:"Long-term storage"}),(0,i.jsx)(n.td,{children:"Vector DB secondary"}),(0,i.jsx)(n.td,{children:"~100-500ms"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"layer-characteristics",children:"Layer Characteristics"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Working Memory"}),": Ultra-fast, ephemerally, in-memory"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Session Memory"}),": Ephemeral, TTL-based, per-agent session"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Episodic Memory"}),": Medium-term, timestamped events"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Semantic Memory"}),": Long-term, vector search enabled"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Procedural Memory"}),": Facts, rules, structured data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"User Personal Memory"}),": User-specific knowledge with semantic search"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Organization Memory"}),": Shared team knowledge with policies"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Archival Memory"}),": Cold storage, bulk queries"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"cross-layer-queries",children:"Cross-Layer Queries"}),"\n",(0,i.jsx)(n.p,{children:"Providers SHALL support concurrent queries across multiple layers with intelligent result aggregation:"}),"\n",(0,i.jsx)(n.h4,{id:"scenario-cross-layer-query-with-ranking-1",children:"Scenario: Cross-layer query with ranking"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WHEN"})," a query is submitted with multiple layer types specified"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"THEN"})," all specified layers are queried concurrently"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," results are aggregated and ranked by relevance score"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," total execution time includes all layer query times"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," metadata reports which layers contributed results"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"openspec-protocol-specification",children:"OpenSpec Protocol Specification"}),"\n",(0,i.jsx)(n.h3,{id:"requirement-discovery-endpoint",children:"Requirement: Discovery Endpoint"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide a discovery endpoint for providers to expose capabilities and configuration."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"GET /openspec/v1/knowledge"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Discover provider capabilities and configuration"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface DiscoveryRequest {\n  // No parameters required\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface DiscoveryResponse {\n  provider: {\n    name: string;              // e.g., "Aeterna"\n    version: string;           // e.g., "1.0.0"\n    description: string;\n\n    capabilities: {\n      query: QueryCapabilities;\n      storage: StorageCapabilities;\n      metadata: MetadataCapabilities;\n      streaming: StreamingCapabilities;\n    };\n\n    supported_sources: KnowledgeSourceType[];\n\n    limits: {\n      max_entry_size: number;      // bytes\n      max_batch_size: number;       // entries\n      max_embeddings_dim: number;    // dimensions\n      query_rate_limit?: number;     // queries/minute\n    };\n\n    features: {\n      semantic_search: boolean;      // Vector similarity\n      hybrid_search: boolean;       // Semantic + keyword\n      reranking: boolean;           // Result reranking\n      cross_layer_query: boolean;  // Query multiple layers\n      versioning: boolean;          // Knowledge versioning\n      promotion: boolean;           // Auto-promote between layers\n    };\n  };\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"requirement-query-endpoint",children:"Requirement: Query Endpoint"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide a query endpoint for searching and retrieving knowledge entries."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"POST /openspec/v1/knowledge/query"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Search and retrieve knowledge entries"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface QueryRequest {\n  query: string;\n  mode?: "semantic" | "keyword" | "hybrid";\n\n  filters?: {\n    source_type?: KnowledgeSourceType;\n    access_policy?: AccessPolicy;\n    created_after?: ISO8601;\n    created_before?: ISO8601;\n    tags?: string[];\n    author?: string;\n    custom_filters?: Record<string, any>;\n  };\n\n  options?: {\n    limit?: number;                // Default: 10\n    offset?: number;               // Default: 0\n    distance_threshold?: number;    // Max distance for semantic search\n    distance_metric?: "cosine" | "euclidean" | "dot";\n    include_content?: boolean;    // Default: true\n    include_embeddings?: boolean; // Default: false\n    top_k?: number;              // For semantic search\n  };\n\n  layer?: {\n    types?: ("working" | "session" | "episodic" | "semantic" |\n            "procedural" | "user" | "organization" | "archival")[];\n    agent_id?: string;             // For agent-specific queries\n    user_id?: string;              // For user-specific queries\n  };\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface QueryResponse {\n  query_id: string;\n  results: QueryResult[];\n  metadata: QueryMetadata;\n  streaming_url?: string;        // If streaming enabled\n}\n\ninterface QueryResult {\n  entry: KnowledgeEntry;\n  score: number;                 // Relevance score (0.0-1.0)\n  distance?: number;             // For semantic search\n  highlight?: {\n    content: string[];          // Highlighted snippets\n    metadata?: Record<string, string[]>;\n  };\n}\n\ninterface QueryMetadata {\n  total_results: number;\n  execution_time_ms: number;\n  layers_queried: string[];    // Layers that were searched\n  provider: {\n    name: string;\n    version: string;\n  };\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"scenario-semantic-search-query",children:"Scenario: Semantic search query"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WHEN"}),' a client submits a semantic query with mode="semantic"']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"THEN"})," provider performs vector similarity search"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," results are ordered by similarity score"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," distance metric is applied as specified (default: cosine)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," execution time is <200ms for semantic layer queries"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"scenario-cross-layer-query",children:"Scenario: Cross-layer query"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WHEN"})," a client specifies multiple layer types in layer.types"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"THEN"})," all specified layers are queried concurrently"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," results from all layers are aggregated"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," results are ranked by combined relevance score"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," metadata includes all layers that were queried"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"requirement-createupdate-endpoint",children:"Requirement: Create/Update Endpoint"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide endpoints for creating and updating knowledge entries."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"POST /openspec/v1/knowledge/create"}),"\n",(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"PUT /openspec/v1/knowledge/{id}"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Store or update knowledge entries"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface CreateRequest {\n  entry: Omit<KnowledgeEntry, "id" | "created_at" | "updated_at">;\n\n  options?: {\n    generate_embedding?: boolean;  // Auto-generate embedding\n    access_policy?: AccessPolicyConfig;\n    version?: boolean;              // Enable versioning\n    layer?: {                    // Target memory layer\n      type: MemoryLayerType;\n      agent_id?: string;\n      user_id?: string;\n    };\n  };\n\n  governance?: {\n    require_approval?: boolean;   // Require human approval\n    verification_required?: boolean;\n    audit_log?: boolean;\n  };\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface CreateResponse {\n  entry: KnowledgeEntry;\n  status: "created" | "updated" | "pending_approval";\n\n  approval_required?: {\n    request_id: string;\n    requested_by: string;\n    requested_at: ISO8601;\n  };\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"scenario-create-entry-with-auto-embedding",children:"Scenario: Create entry with auto-embedding"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WHEN"})," a client creates a knowledge entry with options.generate_embedding=true"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"THEN"})," provider generates vector embedding for the content"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," stores both content and embedding"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," returns the created entry with embedding populated"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," generation completes within specified latency targets"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"requirement-delete-endpoint",children:"Requirement: Delete Endpoint"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide an endpoint for removing knowledge entries."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"DELETE /openspec/v1/knowledge/{id}"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Remove knowledge entries"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface DeleteRequest {\n  id: string;\n\n  options?: {\n    hard_delete?: boolean;       // Remove all versions\n    governance?: {\n      require_approval?: boolean;\n      reason?: string;           // Reason for deletion\n    };\n  };\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface DeleteResponse {\n  deleted: boolean;\n  entry_id: string;\n\n  approval_required?: {\n    request_id: string;\n    requested_by: string;\n    requested_at: ISO8601;\n  };\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"requirement-batch-operations-endpoint",children:"Requirement: Batch Operations Endpoint"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide a batch operations endpoint for bulk create, update, and delete operations."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"POST /openspec/v1/knowledge/batch"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Bulk operations (create, update, delete)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface BatchRequest {\n  operation: "create" | "update" | "delete" | "upsert";\n  entries: (CreateRequest | UpdateRequest | DeleteRequest)[];\n  options?: {\n    continue_on_error?: boolean;  // Don\'t stop on first error\n    notify_on_completion?: boolean;\n  };\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface BatchResponse {\n  operation_id: string;\n  status: "pending" | "processing" | "completed" | "failed";\n\n  results: {\n    succeeded: number;\n    failed: number;\n    errors: BatchError[];\n  };\n\n  results_url?: string;    // Download link when completed\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"requirement-streaming-endpoint",children:"Requirement: Streaming Endpoint"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide a streaming endpoint for real-time knowledge updates and query results."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"GET /openspec/v1/knowledge/stream"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Stream real-time knowledge updates and query results"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface StreamRequest {\n  type: "query" | "updates" | "notifications";\n  query?: QueryRequest;          // For query streaming\n  filters?: UpdateFilters;       // For update streaming\n\n  format?: "sse" | "websocket";\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response (SSE)"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// Server-Sent Events format\nevent: KnowledgeUpdateEvent | QueryResultEvent | NotificationEvent\n\ninterface KnowledgeUpdateEvent {\n  type: "created" | "updated" | "deleted";\n  entry: KnowledgeEntry;\n  timestamp: ISO8601;\n}\n\ninterface QueryResultEvent {\n  query_id: string;\n  result: QueryResult;\n  is_final: boolean;      // True if this is last result\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"scenario-stream-knowledge-updates",children:"Scenario: Stream knowledge updates"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WHEN"}),' a client establishes SSE connection to /stream with type="updates"']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"THEN"})," provider sends real-time events for all knowledge operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," events include created, updated, deleted operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," each event includes entry data and timestamp"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AND"})," connection remains open until client disconnects"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"requirement-metadata-operations-endpoint",children:"Requirement: Metadata Operations Endpoint"}),"\n",(0,i.jsx)(n.p,{children:"The system SHALL provide an endpoint for retrieving metadata without retrieving full content."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Endpoint"}),": ",(0,i.jsx)(n.code,{children:"GET /openspec/v1/knowledge/{id}/metadata"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Retrieve metadata without content"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface MetadataRequest {\n  id: string;\n  include_custom?: boolean;   // Include custom metadata fields\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface MetadataResponse {\n  entry_id: string;\n  metadata: KnowledgeMetadata;\n  source: KnowledgeSource;\n  version_history?: {\n    version: number;\n    created_at: ISO8601;\n    created_by: string;\n  }[];\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"security--authentication",children:"Security & Authentication"}),"\n",(0,i.jsx)(n.h3,{id:"authentication-methods",children:"Authentication Methods"}),"\n",(0,i.jsx)(n.h4,{id:"bearer-token-authentication",children:"Bearer Token Authentication"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface AuthConfig {\n  type: "bearer" | "api_key" | "oauth2";\n  token: string;\n  expires_at?: ISO8601;\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"authorization",children:"Authorization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface AuthorizationConfig {\n  policies: {\n    read: AccessPolicy[];       // Who can read knowledge\n    write: AccessPolicy[];      // Who can write knowledge\n    delete: AccessPolicy[];     // Who can delete knowledge\n  };\n\n  roles: {\n    admin: string[];           // Admin role IDs\n    user: string[];            // Standard user role IDs\n    agent: string[];            // Agent role IDs\n  };\n\n  rate_limits: {\n    queries_per_minute: number;\n    creates_per_minute: number;\n    batch_size_limit: number;\n  };\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"security-headers",children:"Security Headers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface SecurityHeaders {\n  "X-Request-ID": string;           // Unique request ID\n  "X-Rate-Limit-Remaining": string;  // Remaining requests\n  "X-Rate-Limit-Reset": string;       // Rate limit reset time\n  "X-Provider-Version": string;         // Provider version\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.h3,{id:"error-codes",children:"Error Codes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"enum ErrorCode {\n  // Client Errors (4xx)\n  INVALID_REQUEST = 400,\n  UNAUTHORIZED = 401,\n  FORBIDDEN = 403,\n  NOT_FOUND = 404,\n  CONFLICT = 409,\n  RATE_LIMITED = 429,\n\n  // Server Errors (5xx)\n  INTERNAL_ERROR = 500,\n  NOT_IMPLEMENTED = 501,\n  SERVICE_UNAVAILABLE = 503,\n\n  // Provider-Specific Errors\n  EMBEDDING_FAILED = 1001,\n  STORAGE_FAILED = 1002,\n  QUERY_FAILED = 1003,\n  BATCH_FAILED = 1004,\n  GOVERNANCE_DENIED = 1005,\n}\n\ninterface ErrorResponse {\n  error: {\n    code: ErrorCode;\n    message: string;\n    details?: any;\n  };\n\n  request_id: string;           // For debugging\n  timestamp: ISO8601;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"performance-requirements",children:"Performance Requirements"}),"\n",(0,i.jsx)(n.h3,{id:"latency-targets",children:"Latency Targets"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Operation"}),(0,i.jsx)(n.th,{children:"P50"}),(0,i.jsx)(n.th,{children:"P95"}),(0,i.jsx)(n.th,{children:"P99"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Query (working memory)"})}),(0,i.jsx)(n.td,{children:"1ms"}),(0,i.jsx)(n.td,{children:"5ms"}),(0,i.jsx)(n.td,{children:"10ms"}),(0,i.jsx)(n.td,{children:"In-memory cache"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Query (session memory)"})}),(0,i.jsx)(n.td,{children:"5ms"}),(0,i.jsx)(n.td,{children:"20ms"}),(0,i.jsx)(n.td,{children:"50ms"}),(0,i.jsx)(n.td,{children:"Cache with TTL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Query (episodic memory)"})}),(0,i.jsx)(n.td,{children:"20ms"}),(0,i.jsx)(n.td,{children:"50ms"}),(0,i.jsx)(n.td,{children:"100ms"}),(0,i.jsx)(n.td,{children:"Structured DB"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Query (semantic memory)"})}),(0,i.jsx)(n.td,{children:"50ms"}),(0,i.jsx)(n.td,{children:"100ms"}),(0,i.jsx)(n.td,{children:"200ms"}),(0,i.jsx)(n.td,{children:"Vector DB"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Query (archival memory)"})}),(0,i.jsx)(n.td,{children:"100ms"}),(0,i.jsx)(n.td,{children:"200ms"}),(0,i.jsx)(n.td,{children:"500ms"}),(0,i.jsx)(n.td,{children:"Cold storage"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Create entry"})}),(0,i.jsx)(n.td,{children:"50ms"}),(0,i.jsx)(n.td,{children:"100ms"}),(0,i.jsx)(n.td,{children:"200ms"}),(0,i.jsx)(n.td,{children:"Includes embedding"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Update entry"})}),(0,i.jsx)(n.td,{children:"20ms"}),(0,i.jsx)(n.td,{children:"50ms"}),(0,i.jsx)(n.td,{children:"100ms"}),(0,i.jsx)(n.td,{children:"Without embedding"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Delete entry"})}),(0,i.jsx)(n.td,{children:"10ms"}),(0,i.jsx)(n.td,{children:"30ms"}),(0,i.jsx)(n.td,{children:"50ms"}),(0,i.jsx)(n.td,{children:"Soft delete"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"throughput-targets",children:"Throughput Targets"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric"}),(0,i.jsx)(n.th,{children:"Target"}),(0,i.jsx)(n.th,{children:"Measurement"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Queries per second"})}),(0,i.jsx)(n.td,{children:"> 100 QPS"}),(0,i.jsx)(n.td,{children:"Concurrent queries"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Creates per second"})}),(0,i.jsx)(n.td,{children:"> 50 CPS"}),(0,i.jsx)(n.td,{children:"Includes embedding"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Batch operations"})}),(0,i.jsx)(n.td,{children:"> 1000 ops/min"}),(0,i.jsx)(n.td,{children:"Bulk operations"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Streaming events"})}),(0,i.jsx)(n.td,{children:"> 1000 events/sec"}),(0,i.jsx)(n.td,{children:"SSE/WebSocket"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"testing-requirements",children:"Testing Requirements"}),"\n",(0,i.jsx)(n.h3,{id:"test-coverage",children:"Test Coverage"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Component Type"}),(0,i.jsx)(n.th,{children:"Unit Test Target"}),(0,i.jsx)(n.th,{children:"Integration Target"}),(0,i.jsx)(n.th,{children:"Overall Target"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Business Logic"})}),(0,i.jsx)(n.td,{children:"90%+"}),(0,i.jsx)(n.td,{children:"85%+"}),(0,i.jsx)(n.td,{children:"85%+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Data Models"})}),(0,i.jsx)(n.td,{children:"95%+"}),(0,i.jsx)(n.td,{children:"N/A"}),(0,i.jsx)(n.td,{children:"95%+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"API Endpoints"})}),(0,i.jsx)(n.td,{children:"85%+"}),(0,i.jsx)(n.td,{children:"85%+"}),(0,i.jsx)(n.td,{children:"85%+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Database Layer"})}),(0,i.jsx)(n.td,{children:"85%+"}),(0,i.jsx)(n.td,{children:"80%+"}),(0,i.jsx)(n.td,{children:"80%+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Vector DB Layer"})}),(0,i.jsx)(n.td,{children:"85%+"}),(0,i.jsx)(n.td,{children:"80%+"}),(0,i.jsx)(n.td,{children:"80%+"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Query Engine"})}),(0,i.jsx)(n.td,{children:"90%+"}),(0,i.jsx)(n.td,{children:"85%+"}),(0,i.jsx)(n.td,{children:"85%+"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"testability",children:"Testability"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Requirement"}),": All external dependencies MUST be behind trait abstractions to enable easy mocking and testing."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",children:"#[async_trait]\npub trait EmbeddingProvider: Send + Sync {\n    async fn embed(&self, text: &str) -> Result<Vec<f32>, Error>;\n    async fn embed_batch(&self, texts: Vec<&str>) -> Result<Vec<Vec<f32>>, Error>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"property-based-testing",children:"Property-Based Testing"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Requirement"}),": All critical algorithms MUST be tested with property-based testing frameworks."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Critical Algorithms"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Promotion Score Calculation"}),"\n",(0,i.jsx)(n.li,{children:"Cross-Layer Query Result Ordering"}),"\n",(0,i.jsx)(n.li,{children:"Embedding Similarity Metrics"}),"\n",(0,i.jsx)(n.li,{children:"Confidence Aggregation"}),"\n",(0,i.jsx)(n.li,{children:"Conflict Resolution"}),"\n",(0,i.jsx)(n.li,{children:"Version Merging"}),"\n",(0,i.jsx)(n.li,{children:"Access Policy Evaluation"}),"\n",(0,i.jsx)(n.li,{children:"Search Result Ranking"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"mutation-testing",children:"Mutation Testing"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Requirement"}),": Critical code paths MUST achieve 90%+ mutation score (90%+ mutants killed)."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"openapi-specification",children:"OpenAPI Specification"}),"\n",(0,i.jsx)(n.p,{children:"All OpenSpec Knowledge Providers MUST provide an OpenAPI 3.0 specification documenting:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"All endpoints"}),"\n",(0,i.jsx)(n.li,{children:"Request/response schemas"}),"\n",(0,i.jsx)(n.li,{children:"Authentication methods"}),"\n",(0,i.jsx)(n.li,{children:"Error responses"}),"\n",(0,i.jsx)(n.li,{children:"Rate limits"}),"\n",(0,i.jsx)(n.li,{children:"Examples"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"compliance-checklist",children:"Compliance Checklist"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Requirement"}),(0,i.jsx)(n.th,{children:"Status"}),(0,i.jsx)(n.th,{children:"Implementation Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Discovery endpoint"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GET /openspec/v1/knowledge"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Query endpoint"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"POST /openspec/v1/knowledge/query"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Create/Update endpoint"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"POST /openspec/v1/knowledge/create"})," + ",(0,i.jsx)(n.code,{children:"PUT /openspec/v1/knowledge/{id}"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Delete endpoint"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DELETE /openspec/v1/knowledge/{id}"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Batch operations"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"POST /openspec/v1/knowledge/batch"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Streaming endpoint"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GET /openspec/v1/knowledge/stream"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Metadata operations"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GET /openspec/v1/knowledge/{id}/metadata"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Authentication"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:"Bearer token + OAuth2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Error handling"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:"Full error code system"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Performance requirements"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:"Latency targets, throughput targets"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Testing requirements"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:"Unit, integration, performance tests"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"OpenAPI spec"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:"OpenAPI 3.0 specification"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Documentation"})}),(0,i.jsx)(n.td,{children:"\u2705 Required"}),(0,i.jsx)(n.td,{children:"Complete API reference + examples"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Knowledge Provider Specification v1.0.0"}),"\n",(0,i.jsx)(n.em,{children:"Last Updated: 2026-01-07"}),"\n",(0,i.jsx)(n.em,{children:"OpenSpec-Compliant"})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,r){r.d(n,{R:()=>d,x:()=>l});var s=r(6540);const i={},t=s.createContext(i);function d(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);