"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[885],{1431(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"governance/troubleshooting","title":"Governance System Troubleshooting Guide","description":"This guide provides comprehensive troubleshooting steps for common governance issues in the Aeterna Memory-Knowledge System.","source":"@site/docs/governance/troubleshooting.md","sourceDirName":"governance","slug":"/governance/troubleshooting","permalink":"/aeterna/docs/governance/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/governance/troubleshooting.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Drift Detection Tuning Guide","permalink":"/aeterna/docs/governance/drift-tuning"},"next":{"title":"UX-First Governance: Natural Language Policy Management","permalink":"/aeterna/docs/guides/ux-first-governance"}}');var r=i(4848),t=i(8453);const o={},l="Governance System Troubleshooting Guide",c={},a=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Common Error Messages",id:"common-error-messages",level:2},{value:"&quot;No mandatory policies detected for this project layer&quot;",id:"no-mandatory-policies-detected-for-this-project-layer",level:3},{value:"&quot;Embedding service not configured&quot;",id:"embedding-service-not-configured",level:3},{value:"&quot;LLM drift analysis failed&quot;",id:"llm-drift-analysis-failed",level:3},{value:"Policy Validation Issues",id:"policy-validation-issues",level:2},{value:"Policy Rules Not Evaluating",id:"policy-rules-not-evaluating",level:3},{value:"1. Wrong Target Context",id:"1-wrong-target-context",level:4},{value:"2. Invalid Regex Patterns",id:"2-invalid-regex-patterns",level:4},{value:"3. Rule Type Mismatch",id:"3-rule-type-mismatch",level:4},{value:"Policy Inheritance Not Working",id:"policy-inheritance-not-working",level:3},{value:"1. Override Strategy Not Used",id:"1-override-strategy-not-used",level:4},{value:"2. Mandatory Policy Override Attempt",id:"2-mandatory-policy-override-attempt",level:4},{value:"Drift Detection Problems",id:"drift-detection-problems",level:2},{value:"Slow Drift Detection",id:"slow-drift-detection",level:3},{value:"1. Tune Embedding Service",id:"1-tune-embedding-service",level:4},{value:"2. Optimize Policy Evaluation",id:"2-optimize-policy-evaluation",level:4},{value:"3. Cache Drift Results",id:"3-cache-drift-results",level:4},{value:"False Positive Drift Detection",id:"false-positive-drift-detection",level:3},{value:"1. Adjust Semantic Threshold",id:"1-adjust-semantic-threshold",level:4},{value:"2. Update Policy Version Hashes",id:"2-update-policy-version-hashes",level:4},{value:"Storage Connection Issues",id:"storage-connection-issues",level:2},{value:"PostgreSQL Connection Failures",id:"postgresql-connection-failures",level:3},{value:"1. Connection Timeout",id:"1-connection-timeout",level:4},{value:"2. Authentication Failures",id:"2-authentication-failures",level:4},{value:"3. Database Not Found",id:"3-database-not-found",level:4},{value:"4. Missing Extensions",id:"4-missing-extensions",level:4},{value:"Redis Connection Issues",id:"redis-connection-issues",level:3},{value:"Qdrant Vector Database Issues",id:"qdrant-vector-database-issues",level:3},{value:"Permit.io Integration",id:"permitio-integration",level:2},{value:"Hybrid Mode Configuration",id:"hybrid-mode-configuration",level:3},{value:"Remote API Errors",id:"remote-api-errors",level:3},{value:"1. Authentication Headers Missing",id:"1-authentication-headers-missing",level:4},{value:"2. Network Timeouts",id:"2-network-timeouts",level:4},{value:"3. API Response Format Errors",id:"3-api-response-format-errors",level:4},{value:"Sync Conflicts",id:"sync-conflicts",level:3},{value:"Performance Troubleshooting",id:"performance-troubleshooting",level:2},{value:"High Memory Usage",id:"high-memory-usage",level:3},{value:"1. Optimize Cache Configuration",id:"1-optimize-cache-configuration",level:4},{value:"2. Batch Policy Evaluation",id:"2-batch-policy-evaluation",level:4},{value:"Slow Policy Resolution",id:"slow-policy-resolution",level:3},{value:"1. Index Policy Rules",id:"1-index-policy-rules",level:4},{value:"2. Pre-compile Regex Patterns",id:"2-pre-compile-regex-patterns",level:4},{value:"3. Use Efficient Storage Queries",id:"3-use-efficient-storage-queries",level:4},{value:"Debugging Checklist",id:"debugging-checklist",level:2},{value:"Enable Verbose Logging",id:"enable-verbose-logging",level:3},{value:"Inspect Resolved Policies",id:"inspect-resolved-policies",level:3},{value:"Trace Policy Inheritance",id:"trace-policy-inheritance",level:3},{value:"Validate Context Structure",id:"validate-context-structure",level:3},{value:"Monitor Storage Performance",id:"monitor-storage-performance",level:3},{value:"FAQ",id:"faq",level:2},{value:"Q: Why are my policies not being evaluated?",id:"q-why-are-my-policies-not-being-evaluated",level:3},{value:"Q: How do I debug policy inheritance?",id:"q-how-do-i-debug-policy-inheritance",level:3},{value:"Q: My drift detection is too slow",id:"q-my-drift-detection-is-too-slow",level:3},{value:"Q: Governance is blocking valid changes",id:"q-governance-is-blocking-valid-changes",level:3},{value:"Q: Remote governance isn&#39;t syncing",id:"q-remote-governance-isnt-syncing",level:3},{value:"Q: How do I add new constraint operators?",id:"q-how-do-i-add-new-constraint-operators",level:3},{value:"Q: What&#39;s the difference between policy modes?",id:"q-whats-the-difference-between-policy-modes",level:3},{value:"Q: How do I test policies without affecting production?",id:"q-how-do-i-test-policies-without-affecting-production",level:3},{value:"Q: Why are my policy changes not taking effect?",id:"q-why-are-my-policy-changes-not-taking-effect",level:3},{value:"Emergency Procedures",id:"emergency-procedures",level:2},{value:"Governance Engine Not Responding",id:"governance-engine-not-responding",level:3},{value:"Storage Outage Recovery",id:"storage-outage-recovery",level:3},{value:"Policy Corruption",id:"policy-corruption",level:3},{value:"Contact and Support",id:"contact-and-support",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"governance-system-troubleshooting-guide",children:"Governance System Troubleshooting Guide"})}),"\n",(0,r.jsx)(n.p,{children:"This guide provides comprehensive troubleshooting steps for common governance issues in the Aeterna Memory-Knowledge System."}),"\n",(0,r.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#common-error-messages",children:"Common Error Messages"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#policy-validation-issues",children:"Policy Validation Issues"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#drift-detection-problems",children:"Drift Detection Problems"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#storage-connection-issues",children:"Storage Connection Issues"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#permitio-integration",children:"Permit.io Integration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#performance-troubleshooting",children:"Performance Troubleshooting"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#debugging-checklist",children:"Debugging Checklist"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#faq",children:"FAQ"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-error-messages",children:"Common Error Messages"}),"\n",(0,r.jsx)(n.h3,{id:"no-mandatory-policies-detected-for-this-project-layer",children:'"No mandatory policies detected for this project layer"'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": This warning occurs when governance evaluation completes but finds no policies marked as ",(0,r.jsx)(n.code,{children:"PolicyMode::Mandatory"})," for the target layer and its hierarchy."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why it happens"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Project only has optional policies"}),"\n",(0,r.jsx)(n.li,{children:"Mandatory policies exist at higher layers but don't apply to target layer"}),"\n",(0,r.jsx)(n.li,{children:"Policy inheritance hierarchy is broken"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Add a mandatory policy at company level\nlet company_policy = Policy {\n    id: "baseline-security".to_string(),\n    name: "Baseline Security".to_string(),\n    layer: KnowledgeLayer::Company,\n    mode: PolicyMode::Mandatory,  // This is required\n    merge_strategy: RuleMergeStrategy::Merge,\n    rules: vec![\n        PolicyRule {\n            id: "no-secrets".to_string(),\n            rule_type: RuleType::Allow,\n            target: ConstraintTarget::Code,\n            operator: ConstraintOperator::MustNotMatch,\n            value: serde_json::json!("SECRET_.*"),\n            severity: ConstraintSeverity::Block,\n            message: "No secrets allowed in code".to_string(),\n        }\n    ],\n    metadata: HashMap::new(),\n};\n\nengine.add_policy(company_policy);\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debugging steps"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Enable verbose logging: ",(0,r.jsx)(n.code,{children:"RUST_LOG=debug"})]}),"\n",(0,r.jsx)(n.li,{children:"Check policy hierarchy: ensure mandatory policies exist at Company, Org, or Team layers"}),"\n",(0,r.jsx)(n.li,{children:"Verify policy IDs are unique across layers"}),"\n",(0,r.jsx)(n.li,{children:"Check merge strategies don't override mandatory policies incorrectly"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"embedding-service-not-configured",children:'"Embedding service not configured"'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": Drift detection with semantic analysis requires an embedding service, but none is provided to the GovernanceEngine."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Configure embedding service\nlet embedding_service = Arc::new(YourEmbeddingService::new());\nlet mut engine = GovernanceEngine::new()\n    .with_embedding_service(embedding_service);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Workaround"}),": Disable semantic drift detection by removing content from drift check context or ensure embedding service is configured."]}),"\n",(0,r.jsx)(n.h3,{id:"llm-drift-analysis-failed",children:'"LLM drift analysis failed"'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause"}),": LLM service is unavailable or returns an error during drift analysis."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Configure LLM service properly\nlet llm_service = Arc::new(YourLlmService::new());\nlet mut engine = GovernanceEngine::new()\n    .with_llm_service(llm_service);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debugging"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check LLM service API keys and endpoints"}),"\n",(0,r.jsx)(n.li,{children:"Verify network connectivity to LLM provider"}),"\n",(0,r.jsx)(n.li,{children:"Check service quotas and rate limits"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"policy-validation-issues",children:"Policy Validation Issues"}),"\n",(0,r.jsx)(n.h3,{id:"policy-rules-not-evaluating",children:"Policy Rules Not Evaluating"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms"}),": Policies exist but violations aren't detected when they should be."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common causes"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-wrong-target-context",children:"1. Wrong Target Context"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// INCORRECT - Missing context key\nlet mut context = HashMap::new();\n// No "dependencies" key for dependency rule\n\n// CORRECT - Provide required context\nlet mut context = HashMap::new();\ncontext.insert("dependencies".to_string(), serde_json::json!(["jquery", "lodash"]));\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-invalid-regex-patterns",children:"2. Invalid Regex Patterns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// INCORRECT - Invalid regex\nvalue: serde_json::json!("^[unclosed regex")\n\n// CORRECT - Valid regex with proper escaping\nvalue: serde_json::json!("^#\\\\s*ADR\\\\s+\\\\d+")\n'})}),"\n",(0,r.jsx)(n.h4,{id:"3-rule-type-mismatch",children:"3. Rule Type Mismatch"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// INCORRECT - Using Allow rule with MustUse (should be Deny)\nPolicyRule {\n    rule_type: RuleType::Allow,\n    operator: ConstraintOperator::MustUse,\n    // ...\n}\n\n// CORRECT - Deny rule with MustUse (forbidden dependency)\nPolicyRule {\n    rule_type: RuleType::Deny,\n    operator: ConstraintOperator::MustUse,\n    // ...\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"policy-inheritance-not-working",children:"Policy Inheritance Not Working"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms"}),": Child layer policies don't inherit or override parent policies correctly."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debugging steps"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Enable debug logging to see policy resolution\nuse tracing::{debug, Level};\ntracing_subscriber::fmt()\n    .with_max_level(Level::DEBUG)\n    .init();\n\n// Check resolved policies manually\nlet resolved_policies = engine.resolve_active_policies(\n    KnowledgeLayer::Project,\n    &context,\n    Some(&tenant_ctx)\n).await;\n\nfor policy in resolved_policies {\n    debug!("Active policy: {} at layer {:?}", policy.id, policy.layer);\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common inheritance issues"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-override-strategy-not-used",children:"1. Override Strategy Not Used"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// INCORRECT - Merge strategy won't override parent rule\nmerge_strategy: RuleMergeStrategy::Merge\n\n// CORRECT - Override to replace parent rule completely\nmerge_strategy: RuleMergeStrategy::Override\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-mandatory-policy-override-attempt",children:"2. Mandatory Policy Override Attempt"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Company mandatory policy - CANNOT be overridden\nlet company_policy = Policy {\n    mode: PolicyMode::Mandatory,\n    // ...\n};\n\n// Project policy with same ID - will be IGNORED\nlet project_policy = Policy {\n    mode: PolicyMode::Optional,\n    merge_strategy: RuleMergeStrategy::Override, // Won't work\n    // ...\n};\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"drift-detection-problems",children:"Drift Detection Problems"}),"\n",(0,r.jsx)(n.h3,{id:"slow-drift-detection",children:"Slow Drift Detection"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Causes"}),": Large content files, slow embedding services, or inefficient policy evaluation."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-tune-embedding-service",children:"1. Tune Embedding Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Use faster embedding model or batch processing\nlet embedding_config = EmbeddingConfig {\n    model: "text-embedding-3-small".to_string(), // Faster model\n    batch_size: 32,\n    timeout_ms: 5000,\n};\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-optimize-policy-evaluation",children:"2. Optimize Policy Evaluation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Use specific regex patterns instead of broad ones\nvalue: serde_json::json!("^API_KEY\\\\s*=\\\\s*[\'\\"][^\'\\"]+[\'\\"]") // Specific\n// vs\nvalue: serde_json::json!(".*KEY.*") // Broad and slow\n'})}),"\n",(0,r.jsx)(n.h4,{id:"3-cache-drift-results",children:"3. Cache Drift Results"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// In HybridGovernanceClient, drift results are cached\nlet client = HybridGovernanceClient::new(remote_url, engine)\n    .with_cache_ttl(Duration::from_secs(600)); // 10 minute cache\n"})}),"\n",(0,r.jsx)(n.h3,{id:"false-positive-drift-detection",children:"False Positive Drift Detection"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Causes"}),": Semantic similarity threshold too low, overly broad policies, or stale policy version hashes."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-adjust-semantic-threshold",children:"1. Adjust Semantic Threshold"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Current threshold is 0.8, increase for fewer false positives\nlet violations = engine.check_contradictions(\n    &tenant_ctx,\n    content,\n    0.9 // Higher threshold = fewer matches\n).await?;\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-update-policy-version-hashes",children:"2. Update Policy Version Hashes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Add version_hash to policy metadata\nlet mut metadata = HashMap::new();\nmetadata.insert("version_hash".to_string(), serde_json::json!("abc123"));\n\nlet policy = Policy {\n    metadata,\n    // ...\n};\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"storage-connection-issues",children:"Storage Connection Issues"}),"\n",(0,r.jsx)(n.h3,{id:"postgresql-connection-failures",children:"PostgreSQL Connection Failures"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common errors and solutions"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-connection-timeout",children:"1. Connection Timeout"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'# config.toml\n[providers.postgres]\nhost = "localhost"\nport = 5432\ntimeout_seconds = 30  # Increase if needed\npool_size = 10        # Decrease if hitting connection limits\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-authentication-failures",children:"2. Authentication Failures"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Set environment variables (recommended)\nexport AETERNA_POSTGRES_PASSWORD="your_password"\nexport AETERNA_POSTGRES_USERNAME="your_user"\n\n# Or use config file\n[providers.postgres]\nusername = "your_user"\npassword = "your_password"\n'})}),"\n",(0,r.jsx)(n.h4,{id:"3-database-not-found",children:"3. Database Not Found"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Create database manually\nCREATE DATABASE memory_knowledge;\n\n-- Or use connection string with database\npostgresql://user:password@localhost:5432/memory_knowledge\n"})}),"\n",(0,r.jsx)(n.h4,{id:"4-missing-extensions",children:"4. Missing Extensions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'-- Required for vector operations\nCREATE EXTENSION IF NOT EXISTS vector;\n\n-- Required for UUID generation\nCREATE EXTENSION IF NOT EXISTS "uuid-ossp";\n'})}),"\n",(0,r.jsx)(n.h3,{id:"redis-connection-issues",children:"Redis Connection Issues"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common problems"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[providers.redis]\nhost = "localhost"\nport = 6379\ntimeout_seconds = 30\npool_size = 10\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debugging"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Test Redis connection\nredis-cli -h localhost -p 6379 ping\n\n# Check Redis is running\nredis-cli info server\n"})}),"\n",(0,r.jsx)(n.h3,{id:"qdrant-vector-database-issues",children:"Qdrant Vector Database Issues"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Configuration"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[providers.qdrant]\nhost = "localhost"\nport = 6333\ncollection = "memory_embeddings"\ntimeout_seconds = 30\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common issues"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Create collection manually\ncurl -X PUT http://localhost:6333/collections/memory_embeddings \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n    "vectors": {\n      "size": 1536,\n      "distance": "Cosine"\n    }\n  }\'\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"permitio-integration",children:"Permit.io Integration"}),"\n",(0,r.jsx)(n.h3,{id:"hybrid-mode-configuration",children:"Hybrid Mode Configuration"}),"\n",(0,r.jsx)(n.p,{children:"For Hybrid and Remote modes, configure remote governance URL:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Environment variables\nexport AETERNA_DEPLOYMENT_MODE="hybrid"\nexport AETERNA_REMOTE_GOVERNANCE_URL="https://your-governance-api.com"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Or in config:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[deployment]\nmode = "hybrid"\nremote_url = "https://your-governance-api.com"\nsync_enabled = true\n'})}),"\n",(0,r.jsx)(n.h3,{id:"remote-api-errors",children:"Remote API Errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Common issues"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-authentication-headers-missing",children:"1. Authentication Headers Missing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Headers are automatically added by HybridGovernanceClient\n// Ensure tenant and user context are properly set\nlet ctx = TenantContext::new(\n    TenantId::new("your-tenant").unwrap(),\n    UserId::new("your-user").unwrap(),\n);\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-network-timeouts",children:"2. Network Timeouts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"let client = HybridGovernanceClient::new(remote_url, engine)\n    .with_cache_ttl(Duration::from_secs(300))\n    .with_sync_interval(Duration::from_secs(60));\n"})}),"\n",(0,r.jsx)(n.h4,{id:"3-api-response-format-errors",children:"3. API Response Format Errors"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Check API response format matches expected ValidationResult\n// Common issue: API returns different JSON structure\n"})}),"\n",(0,r.jsx)(n.h3,{id:"sync-conflicts",children:"Sync Conflicts"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms"}),": Changes not syncing between local and remote governance."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Debugging"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Check sync state\nlet state = client.get_sync_state().await;\nprintln!("Pending changes: {}", state.pending_changes.len());\nprintln!("Local version: {}", state.local_version);\nprintln!("Remote version: {}", state.remote_version);\n\n// Manually sync pending changes\nlet synced = client.sync_pending_changes(&ctx).await?;\nprintln!("Synced {} changes", synced);\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"performance-troubleshooting",children:"Performance Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"high-memory-usage",children:"High Memory Usage"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Causes"}),": Large policy sets, excessive caching, or memory leaks in policy evaluation."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-optimize-cache-configuration",children:"1. Optimize Cache Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Reduce cache TTL for hybrid client\nlet client = HybridGovernanceClient::new(remote_url, engine)\n    .with_cache_ttl(Duration::from_secs(60)); // Was 300\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-batch-policy-evaluation",children:"2. Batch Policy Evaluation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Process policies in batches rather than all at once\nfor batch in policies.chunks(10) {\n    for policy in batch {\n        // Evaluate policy\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"slow-policy-resolution",children:"Slow Policy Resolution"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optimization techniques"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"1-index-policy-rules",children:"1. Index Policy Rules"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Store policies by layer for faster lookup\nlet mut policies_by_layer: HashMap<KnowledgeLayer, Vec<Policy>> = HashMap::new();\nfor policy in policies {\n    policies_by_layer.entry(policy.layer).or_default().push(policy);\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-pre-compile-regex-patterns",children:"2. Pre-compile Regex Patterns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Compile regex once instead of on every evaluation\nlazy_static! {\n    static ref SECRET_PATTERN: Regex = Regex::new(r"SECRET_.*").unwrap();\n}\n\n// Then use in policy evaluation\nif SECRET_PATTERN.is_match(content) {\n    // Violation detected\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"3-use-efficient-storage-queries",children:"3. Use Efficient Storage Queries"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Add indexes for common queries\nCREATE INDEX idx_unit_policies_unit_id ON unit_policies(unit_id);\nCREATE INDEX idx_organizational_units_tenant_id ON organizational_units(tenant_id);\nCREATE INDEX idx_governance_events_timestamp ON governance_events(timestamp);\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"debugging-checklist",children:"Debugging Checklist"}),"\n",(0,r.jsx)(n.h3,{id:"enable-verbose-logging",children:"Enable Verbose Logging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Environment variable\nexport RUST_LOG=debug,aeterna=trace\n\n# Or in code\nuse tracing_subscriber::{layer::SubscriberExt, util::SubscriberInitExt};\ntracing_subscriber::registry()\n    .with(tracing_subscriber::EnvFilter::from_default_env())\n    .with(tracing_subscriber::fmt::layer())\n    .init();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"inspect-resolved-policies",children:"Inspect Resolved Policies"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Get all active policies for debugging\nlet active_policies = engine.resolve_active_policies(\n    KnowledgeLayer::Project,\n    &context,\n    Some(&tenant_ctx)\n).await;\n\nfor policy in &active_policies {\n    println!("Policy: {} at layer {:?}", policy.id, policy.layer);\n    for rule in &policy.rules {\n        println!("  Rule: {} ({})", rule.id, rule.severity);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"trace-policy-inheritance",children:"Trace Policy Inheritance"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Manually trace policy hierarchy\nlet layers = [\n    KnowledgeLayer::Company,\n    KnowledgeLayer::Org,\n    KnowledgeLayer::Team,\n    KnowledgeLayer::Project,\n];\n\nfor layer in &layers {\n    if let Some(layer_policies) = engine.policies.get(layer) {\n        println!("Layer {:?} has {} policies", layer, layer_policies.len());\n        for policy in layer_policies {\n            println!("  - {} ({:?})", policy.id, policy.mode);\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"validate-context-structure",children:"Validate Context Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Ensure context has all required keys\nfn validate_context(context: &HashMap<String, serde_json::Value>) -> Vec<String> {\n    let required_keys = vec!["projectId", "content", "dependencies"];\n    let mut missing = Vec::new();\n    \n    for key in &required_keys {\n        if !context.contains_key(*key) {\n            missing.push(key.to_string());\n        }\n    }\n    \n    missing\n}\n\nlet missing_keys = validate_context(&context);\nif !missing_keys.is_empty() {\n    println!("Missing context keys: {:?}", missing_keys);\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"monitor-storage-performance",children:"Monitor Storage Performance"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Check slow queries\nSELECT query, mean_time, calls \nFROM pg_stat_statements \nORDER BY mean_time DESC \nLIMIT 10;\n\n-- Check table sizes\nSELECT \n    schemaname,\n    tablename,\n    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size\nFROM pg_tables \nWHERE schemaname = 'public'\nORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(n.h3,{id:"q-why-are-my-policies-not-being-evaluated",children:"Q: Why are my policies not being evaluated?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),": Check that:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Context contains the required keys for your rule targets"}),"\n",(0,r.jsx)(n.li,{children:"Policy IDs are unique across all layers"}),"\n",(0,r.jsx)(n.li,{children:"Regex patterns are valid"}),"\n",(0,r.jsx)(n.li,{children:"Rule types match your intent (Allow vs Deny)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"q-how-do-i-debug-policy-inheritance",children:"Q: How do I debug policy inheritance?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Enable debug logging: ",(0,r.jsx)(n.code,{children:"RUST_LOG=debug"})]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"resolve_active_policies()"})," to see what policies are active"]}),"\n",(0,r.jsxs)(n.li,{children:["Check merge strategies - ",(0,r.jsx)(n.code,{children:"Override"})," replaces, ",(0,r.jsx)(n.code,{children:"Merge"})," combines, ",(0,r.jsx)(n.code,{children:"Intersect"})," keeps only common rules"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"q-my-drift-detection-is-too-slow",children:"Q: My drift detection is too slow"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Reduce content size being analyzed"}),"\n",(0,r.jsx)(n.li,{children:"Use faster embedding models"}),"\n",(0,r.jsx)(n.li,{children:"Increase cache TTL in hybrid mode"}),"\n",(0,r.jsx)(n.li,{children:"Optimize regex patterns to be more specific"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"q-governance-is-blocking-valid-changes",children:"Q: Governance is blocking valid changes"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Check policy severity levels - ",(0,r.jsx)(n.code,{children:"Block"})," prevents operations"]}),"\n",(0,r.jsx)(n.li,{children:"Verify rule logic matches your intent"}),"\n",(0,r.jsx)(n.li,{children:"Review mandatory vs optional policy modes"}),"\n",(0,r.jsx)(n.li,{children:"Check for contradictory policies at different layers"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"q-remote-governance-isnt-syncing",children:"Q: Remote governance isn't syncing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify ",(0,r.jsx)(n.code,{children:"AETERNA_REMOTE_GOVERNANCE_URL"})," is set and accessible"]}),"\n",(0,r.jsx)(n.li,{children:"Check authentication headers are being sent"}),"\n",(0,r.jsxs)(n.li,{children:["Monitor sync state with ",(0,r.jsx)(n.code,{children:"get_sync_state()"})]}),"\n",(0,r.jsxs)(n.li,{children:["Manually trigger sync with ",(0,r.jsx)(n.code,{children:"sync_pending_changes()"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"q-how-do-i-add-new-constraint-operators",children:"Q: How do I add new constraint operators?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),": The system supports these operators:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MustExist"}),": Key must be present in context"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MustNotExist"}),": Key must not be present"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MustUse"}),": Value must contain specified item"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MustNotUse"}),": Value must not contain specified item"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MustMatch"}),": Value must match regex pattern"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MustNotMatch"}),": Value must not match regex pattern"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["New operators require modifying the ",(0,r.jsx)(n.code,{children:"evaluate_rule"})," method in ",(0,r.jsx)(n.code,{children:"GovernanceEngine"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"q-whats-the-difference-between-policy-modes",children:"Q: What's the difference between policy modes?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Mandatory"}),": Cannot be overridden by lower layers, always enforced"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Optional"}),": Can be overridden by lower layers using ",(0,r.jsx)(n.code,{children:"Override"})," strategy"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"Mandatory"})," for security and compliance rules"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"Optional"})," for style guidelines and preferences"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"q-how-do-i-test-policies-without-affecting-production",children:"Q: How do I test policies without affecting production?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Use separate tenant contexts for testing"}),"\n",(0,r.jsx)(n.li,{children:"Create test policies with test-specific IDs"}),"\n",(0,r.jsx)(n.li,{children:"Use the validation API directly with test contexts"}),"\n",(0,r.jsxs)(n.li,{children:["Run tests with ",(0,r.jsx)(n.code,{children:"cargo test governance"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"q-why-are-my-policy-changes-not-taking-effect",children:"Q: Why are my policy changes not taking effect?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"A"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Check if policies are cached - restart service or wait for cache expiry"}),"\n",(0,r.jsx)(n.li,{children:"Verify policy IDs are unique (duplicates are ignored)"}),"\n",(0,r.jsx)(n.li,{children:"Ensure policy layer is correct in the hierarchy"}),"\n",(0,r.jsx)(n.li,{children:"Check for syntax errors in policy configuration"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"emergency-procedures",children:"Emergency Procedures"}),"\n",(0,r.jsx)(n.h3,{id:"governance-engine-not-responding",children:"Governance Engine Not Responding"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Check service health: ",(0,r.jsx)(n.code,{children:"curl http://localhost:8080/health"})]}),"\n",(0,r.jsxs)(n.li,{children:["Review logs: ",(0,r.jsx)(n.code,{children:"journalctl -u aeterna-governance -f"})]}),"\n",(0,r.jsxs)(n.li,{children:["Restart service: ",(0,r.jsx)(n.code,{children:"systemctl restart aeterna-governance"})]}),"\n",(0,r.jsx)(n.li,{children:"Check storage connectivity with manual queries"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"storage-outage-recovery",children:"Storage Outage Recovery"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Switch to read-only mode to prevent data loss"}),"\n",(0,r.jsx)(n.li,{children:"Check backup status and restore if needed"}),"\n",(0,r.jsx)(n.li,{children:"Verify storage service is running and accessible"}),"\n",(0,r.jsx)(n.li,{children:"Clear any in-memory caches that might be stale"}),"\n",(0,r.jsx)(n.li,{children:"Gradually resume operations with monitoring"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"policy-corruption",children:"Policy Corruption"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Export current policies from database"}),"\n",(0,r.jsx)(n.li,{children:"Identify and remove corrupted policy entries"}),"\n",(0,r.jsx)(n.li,{children:"Restore policies from backup or configuration"}),"\n",(0,r.jsx)(n.li,{children:"Validate all policies before re-enabling enforcement"}),"\n",(0,r.jsx)(n.li,{children:"Monitor system for unexpected behavior"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"contact-and-support",children:"Contact and Support"}),"\n",(0,r.jsx)(n.p,{children:"For additional support:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Check system logs with ",(0,r.jsx)(n.code,{children:"RUST_LOG=debug"})," enabled"]}),"\n",(0,r.jsx)(n.li,{children:"Review this troubleshooting guide"}),"\n",(0,r.jsx)(n.li,{children:"Check test files for working examples"}),"\n",(0,r.jsx)(n.li,{children:"Consult the architecture documentation"}),"\n",(0,r.jsx)(n.li,{children:"Create detailed issue reports with context and error messages"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);