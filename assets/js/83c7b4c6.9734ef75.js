"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[3143],{7462(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"helm/local-mode","title":"Local Mode Deployment Guide","description":"This document explains local mode \u2014 the default Aeterna deployment pattern where all components run within a single Kubernetes cluster. Local mode is ideal for development, single-cluster production, and air-gapped environments.","source":"@site/docs/helm/local-mode.md","sourceDirName":"helm","slug":"/helm/local-mode","permalink":"/aeterna/docs/helm/local-mode","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/helm/local-mode.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Architecture Overview","permalink":"/aeterna/docs/helm/architecture"},"next":{"title":"Hybrid Mode: Architecture and Data Flow","permalink":"/aeterna/docs/helm/hybrid-mode"}}');var i=s(4848),t=s(8453);const l={},o="Local Mode Deployment Guide",a={},c=[{value:"What is Local Mode?",id:"what-is-local-mode",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Resource Requirements",id:"resource-requirements",level:2},{value:"Minimum Cluster Specifications",id:"minimum-cluster-specifications",level:3},{value:"Recommended Configuration for Production",id:"recommended-configuration-for-production",level:3},{value:"Limitations of Local Mode",id:"limitations-of-local-mode",level:2},{value:"1. Single-Cluster Bound",id:"1-single-cluster-bound",level:3},{value:"2. No Cross-Region Deployment",id:"2-no-cross-region-deployment",level:3},{value:"3. Storage Bound to Cluster",id:"3-storage-bound-to-cluster",level:3},{value:"4. Scaling Constraints",id:"4-scaling-constraints",level:3},{value:"When to Use Local Mode",id:"when-to-use-local-mode",level:2},{value:"\u2705 Good Fit",id:"-good-fit",level:3},{value:"\u274c Poor Fit",id:"-poor-fit",level:3},{value:"Configuration Reference",id:"configuration-reference",level:2},{value:"Core Values for Local Mode",id:"core-values-for-local-mode",level:3},{value:"Storage Configuration",id:"storage-configuration",level:3},{value:"Expansion and Patching",id:"expansion-and-patching",level:3},{value:"Comparison: Local vs Hybrid vs Remote",id:"comparison-local-vs-hybrid-vs-remote",level:2},{value:"Disaster Recovery",id:"disaster-recovery",level:2},{value:"Backup Strategy",id:"backup-strategy",level:3},{value:"Recovery Procedure",id:"recovery-procedure",level:3},{value:"Monitoring in Local Mode",id:"monitoring-in-local-mode",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"local-mode-deployment-guide",children:"Local Mode Deployment Guide"})}),"\n",(0,i.jsxs)(n.p,{children:["This document explains ",(0,i.jsx)(n.strong,{children:"local mode"})," \u2014 the default Aeterna deployment pattern where all components run within a single Kubernetes cluster. Local mode is ideal for development, single-cluster production, and air-gapped environments."]}),"\n",(0,i.jsx)(n.h2,{id:"what-is-local-mode",children:"What is Local Mode?"}),"\n",(0,i.jsxs)(n.p,{children:["In local mode, Aeterna deploys all required components ",(0,i.jsx)(n.strong,{children:"in-cluster"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"PostgreSQL"})," (via CloudNativePG) for episodic memory"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dragonfly"})," or ",(0,i.jsx)(n.strong,{children:"Valkey"})," for session cache (Redis-compatible)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Qdrant"})," vector database for semantic search"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"OPAL"})," authorization engine (Cedar-based policies)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agentic Runtime"})," (Cedar Agent, Planner, Orchestrator)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"All components run in the same Kubernetes cluster. There is no external central server or cloud dependency."}),"\n",(0,i.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Enable local mode in ",(0,i.jsx)(n.code,{children:"values.yaml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"deploymentMode: local\n\n# All components enabled by default\npostgresql:\n  cloudnativepg:\n    enabled: true\n    cluster:\n      instances: 3  # HA setup\n\ncache:\n  enabled: true\n  backend: dragonfly  # or valkey\n\nvectorDatabase:\n  qdrant:\n    enabled: true\n    replicas: 3\n\nopal:\n  enabled: true\n  authBackend: cedar\n"})}),"\n",(0,i.jsx)(n.h2,{id:"resource-requirements",children:"Resource Requirements"}),"\n",(0,i.jsx)(n.h3,{id:"minimum-cluster-specifications",children:"Minimum Cluster Specifications"}),"\n",(0,i.jsx)(n.p,{children:"Local mode requires sufficient resources for HA (high availability) clusters:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Component"}),(0,i.jsx)(n.th,{children:"CPU"}),(0,i.jsx)(n.th,{children:"Memory"}),(0,i.jsx)(n.th,{children:"Storage"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PostgreSQL (3 nodes)"}),(0,i.jsx)(n.td,{children:"500m each"}),(0,i.jsx)(n.td,{children:"2Gi each"}),(0,i.jsx)(n.td,{children:"50Gi-200Gi"}),(0,i.jsx)(n.td,{children:"pgvector extension"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dragonfly (3 nodes)"}),(0,i.jsx)(n.td,{children:"250m each"}),(0,i.jsx)(n.td,{children:"512Mi each"}),(0,i.jsx)(n.td,{children:"10Gi"}),(0,i.jsx)(n.td,{children:"Redis-compatible cache"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Qdrant (3 nodes)"}),(0,i.jsx)(n.td,{children:"300m each"}),(0,i.jsx)(n.td,{children:"512Mi each"}),(0,i.jsx)(n.td,{children:"20Gi-100Gi"}),(0,i.jsx)(n.td,{children:"Vector embeddings"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"OPAL (2 nodes)"}),(0,i.jsx)(n.td,{children:"200m each"}),(0,i.jsx)(n.td,{children:"256Mi each"}),(0,i.jsx)(n.td,{children:"1Gi"}),(0,i.jsx)(n.td,{children:"Cedar policies"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Aeterna (3 pods)"}),(0,i.jsx)(n.td,{children:"200m each"}),(0,i.jsx)(n.td,{children:"512Mi each"}),(0,i.jsx)(n.td,{children:"\u2014"}),(0,i.jsx)(n.td,{children:"Application pods"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Total Minimum"}),": 8GB RAM, 3 nodes, 150GB storage (highly dependent on data volume)"]}),"\n",(0,i.jsx)(n.h3,{id:"recommended-configuration-for-production",children:"Recommended Configuration for Production"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# PostgreSQL (3 replicas for HA)\npostgresql:\n  cloudnativepg:\n    cluster:\n      instances: 3\n      resources:\n        requests:\n          cpu: 1\n          memory: 4Gi\n        limits:\n          cpu: 2\n          memory: 8Gi\n      storage:\n        size: 200Gi\n        storageClass: fast-ssd\n\n# Dragonfly (high-throughput cache)\ncache:\n  dragonfly:\n    replicas: 3\n    resources:\n      requests:\n        cpu: 500m\n        memory: 1Gi\n      limits:\n        cpu: 1\n        memory: 2Gi\n    persistence:\n      size: 30Gi\n\n# Qdrant (vector database)\nvectorDatabase:\n  qdrant:\n    replicas: 3\n    resources:\n      requests:\n        cpu: 500m\n        memory: 1Gi\n      limits:\n        cpu: 2\n        memory: 4Gi\n    storage:\n      size: 50Gi\n\n# Agentic runtime\naeterna:\n  replicas: 3\n  resources:\n    requests:\n      cpu: 500m\n      memory: 1Gi\n    limits:\n      cpu: 1\n      memory: 2Gi\n"})}),"\n",(0,i.jsx)(n.h2,{id:"limitations-of-local-mode",children:"Limitations of Local Mode"}),"\n",(0,i.jsx)(n.h3,{id:"1-single-cluster-bound",children:"1. Single-Cluster Bound"}),"\n",(0,i.jsxs)(n.p,{children:["Local mode runs entirely within ",(0,i.jsx)(n.strong,{children:"one Kubernetes cluster"}),". You cannot:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Distribute agents across multiple geographic regions"}),"\n",(0,i.jsx)(n.li,{children:"Run separate Aeterna instances without data synchronization challenges"}),"\n",(0,i.jsx)(n.li,{children:"Achieve true multi-region failover (only cluster-level HA)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Implication"}),": If the cluster becomes unavailable, Aeterna is unavailable. Use cluster-level backups and disaster recovery tools (e.g., Velero) to protect against cluster loss."]}),"\n",(0,i.jsx)(n.h3,{id:"2-no-cross-region-deployment",children:"2. No Cross-Region Deployment"}),"\n",(0,i.jsxs)(n.p,{children:["Local mode has ",(0,i.jsx)(n.strong,{children:"no mechanism for replicating data across regions"}),". For multi-region requirements, use ",(0,i.jsx)(n.strong,{children:"hybrid mode"})," with a central server and regional cache layers."]}),"\n",(0,i.jsx)(n.h3,{id:"3-storage-bound-to-cluster",children:"3. Storage Bound to Cluster"}),"\n",(0,i.jsxs)(n.p,{children:["All persistent volumes are ",(0,i.jsx)(n.strong,{children:"local to the cluster"}),". You cannot:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Migrate data easily to another cluster"}),"\n",(0,i.jsx)(n.li,{children:"Share data between clusters without external tooling"}),"\n",(0,i.jsx)(n.li,{children:"Detach storage from the cluster independently"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Mitigation"}),": Use external storage (e.g., S3, EBS snapshots) for backups:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'postgresql:\n  cloudnativepg:\n    backup:\n      enabled: true\n      destinationPath: "s3://my-bucket/aeterna-backups"\n      s3Credentials: aeterna-s3-secret\n      schedule: "0 2 * * *"  # Daily at 2 AM\n      retention: 30  # Keep 30 days\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-scaling-constraints",children:"4. Scaling Constraints"}),"\n",(0,i.jsxs)(n.p,{children:["Local mode scaling is limited by ",(0,i.jsx)(n.strong,{children:"cluster capacity"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Vertical scaling: Limited by node size"}),"\n",(0,i.jsx)(n.li,{children:"Horizontal scaling: Limited by cluster node count"}),"\n",(0,i.jsx)(n.li,{children:"Sharding: Not supported; all data in single PostgreSQL instance"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Practical limits"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Up to ~50,000 concurrent agents per cluster (CPU-bound)"}),"\n",(0,i.jsx)(n.li,{children:"Up to ~2TB episodic memory per cluster (storage-bound)"}),"\n",(0,i.jsx)(n.li,{children:"Up to ~10M vector embeddings (Qdrant limits)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"when-to-use-local-mode",children:"When to Use Local Mode"}),"\n",(0,i.jsx)(n.h3,{id:"-good-fit",children:"\u2705 Good Fit"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Development & Testing"}),": Single-node clusters (minikube, kind) for local development"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Single-Region Production"}),": Organizations with data residency in one region"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Air-Gapped Environments"}),": No external connectivity requirements"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Proof of Concept"}),": Rapid deployment without operational complexity"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compliance"}),": All data stays within your cluster (HIPAA, SOC 2)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-poor-fit",children:"\u274c Poor Fit"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multi-Region Deployments"}),": Use hybrid mode instead"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Global Scale"}),": Use remote mode with central server architecture"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"High Availability Across Clusters"}),": Use hybrid mode with regional cache layers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data Sharing Across Orgs"}),": Use remote mode with API access control"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"configuration-reference",children:"Configuration Reference"}),"\n",(0,i.jsx)(n.h3,{id:"core-values-for-local-mode",children:"Core Values for Local Mode"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# Deployment mode\ndeploymentMode: local\n\n# Container registry\nimage:\n  repository: ghcr.io/kikokikok/aeterna\n  tag: "v1.0.0"\n  pullPolicy: IfNotPresent\n\n# Service configuration\nservice:\n  type: ClusterIP  # or LoadBalancer for external access\n  port: 8080\n\n# Ingress (optional)\ningress:\n  enabled: false  # Set to true for HTTP routing\n  className: nginx\n  hosts:\n    - host: aeterna.local\n      paths:\n        - path: /\n          pathType: Prefix\n\n# PostgreSQL (required in local mode)\npostgresql:\n  cloudnativepg:\n    enabled: true\n    cluster:\n      instances: 3\n      postgresql:\n        version: 16\n        parameters:\n          shared_preload_libraries: "pgvector"\n      storage:\n        size: 100Gi\n        storageClass: standard\n\n# Cache layer\ncache:\n  enabled: true\n  backend: dragonfly  # Alternative: valkey\n  dragonfly:\n    enabled: true\n    replicas: 3\n    persistence:\n      enabled: true\n      size: 20Gi\n\n# Vector database\nvectorDatabase:\n  qdrant:\n    enabled: true\n    replicas: 3\n    storage:\n      size: 50Gi\n\n# OPAL (authorization)\nopal:\n  enabled: true\n  authBackend: cedar\n  policyStore: postgresql  # Policies in PostgreSQL\n\n# Network policies\nnetworkPolicy:\n  enabled: true\n  policyTypes:\n    - Ingress\n    - Egress\n\n# Pod security\npodSecurityPolicy:\n  enforce: restricted\n  readOnlyRootFilesystem: true\n'})}),"\n",(0,i.jsx)(n.h3,{id:"storage-configuration",children:"Storage Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Local mode uses ",(0,i.jsx)(n.strong,{children:"PersistentVolumeClaims (PVCs)"})," for all stateful components:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# Define StorageClass for fast SSDs\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: fast-ssd\nprovisioner: ebs.csi.aws.com  # AWS example\nparameters:\n  iops: "3000"\n  throughput: "125"\n  type: gp3\nallowVolumeExpansion: true\n\n---\n# PVC for PostgreSQL\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: aeterna-db-data\nspec:\n  accessModes:\n    - ReadWriteOnce\n  storageClassName: fast-ssd\n  resources:\n    requests:\n      storage: 200Gi\n\n---\n# PVC for Qdrant\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: aeterna-qdrant-data\nspec:\n  accessModes:\n    - ReadWriteOnce\n  storageClassName: fast-ssd\n  resources:\n    requests:\n      storage: 50Gi\n'})}),"\n",(0,i.jsx)(n.h3,{id:"expansion-and-patching",children:"Expansion and Patching"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expand storage"})," (if StorageClass supports ",(0,i.jsx)(n.code,{children:"allowVolumeExpansion"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'kubectl patch pvc aeterna-db-data -p \'{"spec":{"resources":{"requests":{"storage":"300Gi"}}}}\'\n# PostgreSQL will automatically use expanded capacity (no downtime)\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Patch for updates"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade aeterna ./charts/aeterna \\\n  -n aeterna \\\n  -f values-local.yaml \\\n  --wait\n"})}),"\n",(0,i.jsx)(n.h2,{id:"comparison-local-vs-hybrid-vs-remote",children:"Comparison: Local vs Hybrid vs Remote"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"Local"}),(0,i.jsx)(n.th,{children:"Hybrid"}),(0,i.jsx)(n.th,{children:"Remote"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Location"})}),(0,i.jsx)(n.td,{children:"Single cluster"}),(0,i.jsx)(n.td,{children:"Local + central"}),(0,i.jsx)(n.td,{children:"Central only"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Data residency"})}),(0,i.jsx)(n.td,{children:"All local"}),(0,i.jsx)(n.td,{children:"Cached locally"}),(0,i.jsx)(n.td,{children:"All remote"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Setup complexity"})}),(0,i.jsx)(n.td,{children:"Low"}),(0,i.jsx)(n.td,{children:"Medium"}),(0,i.jsx)(n.td,{children:"Medium"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"High availability"})}),(0,i.jsx)(n.td,{children:"Cluster-level"}),(0,i.jsx)(n.td,{children:"Cluster + central"}),(0,i.jsx)(n.td,{children:"Central"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Offline operation"})}),(0,i.jsx)(n.td,{children:"Full access"}),(0,i.jsx)(n.td,{children:"Degraded"}),(0,i.jsx)(n.td,{children:"None"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Multi-region"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Compliance"})}),(0,i.jsx)(n.td,{children:"Local data only"}),(0,i.jsx)(n.td,{children:"Hybrid sync"}),(0,i.jsx)(n.td,{children:"Trust model"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Cost"})}),(0,i.jsx)(n.td,{children:"Compute-heavy"}),(0,i.jsx)(n.td,{children:"Balanced"}),(0,i.jsx)(n.td,{children:"Minimal edge"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Latency"})}),(0,i.jsx)(n.td,{children:"Sub-1ms"}),(0,i.jsx)(n.td,{children:"1-50ms"}),(0,i.jsx)(n.td,{children:"50-500ms"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"disaster-recovery",children:"Disaster Recovery"}),"\n",(0,i.jsx)(n.h3,{id:"backup-strategy",children:"Backup Strategy"}),"\n",(0,i.jsxs)(n.p,{children:["For local mode, implement ",(0,i.jsx)(n.strong,{children:"3-2-1 rule"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"3 copies"})," of data (PostgreSQL replicas, Qdrant replication, S3 backup)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"2 different media"})," (cluster storage + S3)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"1 off-site"})," copy (S3 in different region)"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'postgresql:\n  cloudnativepg:\n    backup:\n      enabled: true\n      schedule: "0 2 * * *"\n      s3:\n        destinationPath: "s3://backup-bucket/aeterna"\n        endpoint: "https://s3.us-west-2.amazonaws.com"\n        existingSecret: s3-credentials\n      retention: 30\n\nvectorDatabase:\n  qdrant:\n    backup:\n      enabled: true\n      schedule: "0 3 * * *"\n      destination: s3://backup-bucket/qdrant-snapshots\n'})}),"\n",(0,i.jsx)(n.h3,{id:"recovery-procedure",children:"Recovery Procedure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# 1. Restore from S3 backup\naws s3 cp s3://backup-bucket/aeterna/latest.tar.gz . --region us-west-2\n\n# 2. Create new PostgreSQL cluster from backup\nkubectl apply -f - <<EOF\napiVersion: postgresql.cnpg.io/v1\nkind: Cluster\nmetadata:\n  name: aeterna-db-restored\nspec:\n  instances: 3\n  bootstrap:\n    recovery:\n      source: backup-s3\n      recoveryTarget:\n        timeline: latest\nEOF\n\n# 3. Verify data integrity\nkubectl exec -it aeterna-db-1 -n aeterna -- psql -U postgres -d aeterna -c "SELECT COUNT(*) FROM knowledge_graph;"\n\n# 4. Restore Qdrant snapshots\ncurl -X PUT "http://qdrant:6333/snapshots/recover" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"snapshot_path":"s3://backup-bucket/qdrant-snapshots/latest"}\'\n'})}),"\n",(0,i.jsx)(n.h2,{id:"monitoring-in-local-mode",children:"Monitoring in Local Mode"}),"\n",(0,i.jsx)(n.p,{children:"Essential dashboards for local mode:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# PostgreSQL replication lag\nkubectl exec -it aeterna-db-1 -n aeterna -- psql -U postgres -c \\\n  \"SELECT EXTRACT(EPOCH FROM now() - pg_last_xact_replay_timestamp()) as replication_lag_seconds;\"\n\n# Cache hit ratio (Dragonfly)\nkubectl exec -it aeterna-cache-0 -n aeterna -- redis-cli INFO stats | grep hit_ratio\n\n# Qdrant collection status\ncurl http://qdrant:6333/collections?details=true | jq '.result[] | {name, points_count}'\n\n# Resource utilization\nkubectl top nodes\nkubectl top pods -n aeterna\n"})}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Local mode is ideal for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Organizations deploying to a single Kubernetes cluster"}),"\n",(0,i.jsx)(n.li,{children:"Environments requiring data residency in one location"}),"\n",(0,i.jsx)(n.li,{children:"Development and testing"}),"\n",(0,i.jsx)(n.li,{children:"Air-gapped deployments"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Key constraints"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Single cluster only (no cross-region)"}),"\n",(0,i.jsx)(n.li,{children:"Storage bound to cluster"}),"\n",(0,i.jsx)(n.li,{children:"Horizontal scaling limited by cluster size"}),"\n",(0,i.jsx)(n.li,{children:"Requires external backups for disaster recovery"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Next steps"}),": If multi-region is needed, see ",(0,i.jsx)(n.strong,{children:"hybrid-mode.md"}),". If minimal edge deployment is needed, see ",(0,i.jsx)(n.strong,{children:"remote-mode.md"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>o});var r=s(6540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);