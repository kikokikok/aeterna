"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[2915],{4518(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"guides/observability-runbook","title":"Observability Runbook","description":"Overview","source":"@site/docs/guides/observability-runbook.md","sourceDirName":"guides","slug":"/guides/observability-runbook","permalink":"/aeterna/docs/guides/observability-runbook","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/guides/observability-runbook.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Disaster Recovery Runbook","permalink":"/aeterna/docs/guides/disaster-recovery-runbook"},"next":{"title":"Managed Observability Platform Integration","permalink":"/aeterna/docs/guides/managed-observability"}}');var s=r(4848),t=r(8453);const a={},o="Observability Runbook",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Dashboard Navigation",id:"dashboard-navigation",level:2},{value:"Alert Response Procedures",id:"alert-response-procedures",level:2},{value:"1. High Latency Spike (p95 &gt; 200ms)",id:"1-high-latency-spike-p95--200ms",level:3},{value:"2. Elevated Error Rate (&gt; 5%)",id:"2-elevated-error-rate--5",level:3},{value:"3. Cost Budget Breach (&gt; 100%)",id:"3-cost-budget-breach--100",level:3},{value:"4. Anomaly Detected (Statistical Baseline Departure)",id:"4-anomaly-detected-statistical-baseline-departure",level:3},{value:"Trace Investigation",id:"trace-investigation",level:2},{value:"Metric Summary Reference",id:"metric-summary-reference",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"observability-runbook",children:"Observability Runbook"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"This runbook provides standardized procedures for responding to alerts, navigating observability dashboards, and investigating system behavior in Aeterna."}),"\n",(0,s.jsx)(n.h2,{id:"dashboard-navigation",children:"Dashboard Navigation"}),"\n",(0,s.jsx)(n.p,{children:"Aeterna provides 5 core Grafana dashboards for system monitoring:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"System Health"}),": CPU, memory, network, and disk usage for all services."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Memory Operations"}),": Throughput, latency, and error rates for memory reads/writes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Knowledge Queries"}),": Performance metrics for knowledge repository searches and sync operations."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Governance & Compliance"}),": Policy evaluation counts, violation trends, and tenant isolation status."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cost Analysis"}),": Per-tenant embedding and storage costs against configured budgets."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"alert-response-procedures",children:"Alert Response Procedures"}),"\n",(0,s.jsx)(n.h3,{id:"1-high-latency-spike-p95--200ms",children:"1. High Latency Spike (p95 > 200ms)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Trigger"}),": ",(0,s.jsx)(n.code,{children:"p99_latency_high"})," alert from Grafana."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Investigation"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Open the ",(0,s.jsx)(n.strong,{children:"Memory Operations"})," dashboard."]}),"\n",(0,s.jsxs)(n.li,{children:["Filter by ",(0,s.jsx)(n.code,{children:"tenant_id"})," if specific to one customer."]}),"\n",(0,s.jsx)(n.li,{children:"Use Tempo to search for traces with duration > 200ms."}),"\n",(0,s.jsxs)(n.li,{children:["Identify if the bottleneck is in ",(0,s.jsx)(n.strong,{children:"Qdrant"})," (vector search) or ",(0,s.jsx)(n.strong,{children:"PostgreSQL"})," (metadata retrieval)."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Remediation"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If vector search is slow: Check Qdrant collection optimization status."}),"\n",(0,s.jsx)(n.li,{children:"If metadata retrieval is slow: Verify database indexing and query execution plans."}),"\n",(0,s.jsx)(n.li,{children:"Scale services if the bottleneck is in the Aeterna application layer."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-elevated-error-rate--5",children:"2. Elevated Error Rate (> 5%)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Trigger"}),": ",(0,s.jsx)(n.code,{children:"memory_error_rate_high"})," alert."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Investigation"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Navigate to the ",(0,s.jsx)(n.strong,{children:"Loki Logs"})," panel in Grafana."]}),"\n",(0,s.jsxs)(n.li,{children:["Search for logs with ",(0,s.jsx)(n.code,{children:"level: error"})," or ",(0,s.jsx)(n.code,{children:"level: fatal"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Filter logs by the ",(0,s.jsx)(n.code,{children:"trace_id"})," from failing requests."]}),"\n",(0,s.jsx)(n.li,{children:"Check for common failure patterns (e.g., database connection timeouts, API rate limits)."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Remediation"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Restart failing service instances if the error is intermittent."}),"\n",(0,s.jsx)(n.li,{children:"Increase connection pool sizes for PostgreSQL or Redis."}),"\n",(0,s.jsx)(n.li,{children:"Scale up the affected service (HPA should handle this automatically)."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-cost-budget-breach--100",children:"3. Cost Budget Breach (> 100%)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Trigger"}),": ",(0,s.jsx)(n.code,{children:"budget_exceeded"})," alert."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Investigation"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Open the ",(0,s.jsx)(n.strong,{children:"Cost Analysis"})," dashboard."]}),"\n",(0,s.jsxs)(n.li,{children:["Identify the ",(0,s.jsx)(n.code,{children:"tenant_id"})," that exceeded its budget."]}),"\n",(0,s.jsxs)(n.li,{children:["Review the ",(0,s.jsx)(n.strong,{children:"Semantic Cache Hit Rate"})," for that tenant."]}),"\n",(0,s.jsx)(n.li,{children:"Check if a high volume of new embeddings is being generated."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Remediation"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Contact the tenant owner to discuss budget increases."}),"\n",(0,s.jsx)(n.li,{children:"Apply a temporary rate limit to the tenant's embedding requests."}),"\n",(0,s.jsx)(n.li,{children:"Tune the semantic cache threshold to increase hit rates."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-anomaly-detected-statistical-baseline-departure",children:"4. Anomaly Detected (Statistical Baseline Departure)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Trigger"}),": Anomaly detection alert on system resources or operation frequency."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Investigation"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Compare the current metric against the historical baseline (last 7 days)."}),"\n",(0,s.jsx)(n.li,{children:"Look for correlated changes in other metrics (e.g., traffic spike + memory increase)."}),"\n",(0,s.jsx)(n.li,{children:"Investigate if the anomaly coincides with a new deployment or configuration change."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Remediation"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Roll back recent deployments if they correlate with the anomaly."}),"\n",(0,s.jsx)(n.li,{children:"Increase resources if the anomaly is due to legitimate traffic growth."}),"\n",(0,s.jsx)(n.li,{children:"Isolate the source of the anomaly (e.g., a specific tenant's aggressive scraping)."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"trace-investigation",children:"Trace Investigation"}),"\n",(0,s.jsxs)(n.p,{children:["Aeterna uses OpenTelemetry for distributed tracing. Traces are linked to logs and metrics via ",(0,s.jsx)(n.code,{children:"trace_id"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Standard Investigation Path"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Find an error in ",(0,s.jsx)(n.strong,{children:"Loki Logs"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Click the ",(0,s.jsx)(n.code,{children:"trace_id"})," link in the log entry to jump to the corresponding ",(0,s.jsx)(n.strong,{children:"Tempo Trace"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Analyze the span hierarchy to identify the specific operation that failed or was slow."}),"\n",(0,s.jsx)(n.li,{children:"Review span metadata for request parameters and error details."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"metric-summary-reference",children:"Metric Summary Reference"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Metric Name"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"aeterna_memory_ops_total"})}),(0,s.jsx)(n.td,{children:"Counter"}),(0,s.jsx)(n.td,{children:"Total memory operations (add, search, delete)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"aeterna_memory_latency_seconds"})}),(0,s.jsx)(n.td,{children:"Histogram"}),(0,s.jsx)(n.td,{children:"Latency of memory operations"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"aeterna_knowledge_sync_duration"})}),(0,s.jsx)(n.td,{children:"Histogram"}),(0,s.jsx)(n.td,{children:"Time taken to sync memory to knowledge"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"aeterna_governance_eval_total"})}),(0,s.jsx)(n.td,{children:"Counter"}),(0,s.jsx)(n.td,{children:"Number of policy evaluations performed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"aeterna_cost_embeddings_usd"})}),(0,s.jsx)(n.td,{children:"Counter"}),(0,s.jsx)(n.td,{children:"Cumulative cost of embedding generation"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"aeterna_cache_hit_ratio"})}),(0,s.jsx)(n.td,{children:"Gauge"}),(0,s.jsx)(n.td,{children:"Semantic cache hit ratio (0.0 - 1.0)"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,r){r.d(n,{R:()=>a,x:()=>o});var i=r(6540);const s={},t=i.createContext(s);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);