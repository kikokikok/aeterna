"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[6451],{1252(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"examples/policies/dependency-management","title":"Dependency Management Policies","description":"Control which libraries and packages can be used across your organization.","source":"@site/docs/examples/policies/dependency-management.md","sourceDirName":"examples/policies","slug":"/examples/policies/dependency-management","permalink":"/aeterna/docs/examples/policies/dependency-management","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/examples/policies/dependency-management.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Architecture Constraints Policies","permalink":"/aeterna/docs/examples/policies/architecture-constraints"},"next":{"title":"Team Conventions Policies","permalink":"/aeterna/docs/examples/policies/team-conventions"}}');var r=s(4848),l=s(8453);const c={},d="Dependency Management Policies",a={},t=[{value:"1. No MySQL",id:"1-no-mysql",level:2},{value:"2. No Moment.js",id:"2-no-momentjs",level:2},{value:"3. No Full Lodash",id:"3-no-full-lodash",level:2},{value:"4. Require OpenTelemetry",id:"4-require-opentelemetry",level:2},{value:"5. No Deprecated Dependencies",id:"5-no-deprecated-dependencies",level:2},{value:"6. Require Security Updates",id:"6-require-security-updates",level:2},{value:"7. Pin Major Versions",id:"7-pin-major-versions",level:2},{value:"8. No Install Scripts",id:"8-no-install-scripts",level:2},{value:"9. Require License Check",id:"9-require-license-check",level:2},{value:"10. Max Bundle Size",id:"10-max-bundle-size",level:2},{value:"Implementation Checklist",id:"implementation-checklist",level:2},{value:"Related Policies",id:"related-policies",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"dependency-management-policies",children:"Dependency Management Policies"})}),"\n",(0,r.jsx)(n.p,{children:"Control which libraries and packages can be used across your organization."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-no-mysql",children:"1. No MySQL"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "Use PostgreSQL instead of MySQL for all new projects"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: no-mysql\n// Scope: company\n// Severity: block\n// Reference: ADR-042\n\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.dependency in ["mysql", "mysql2", "mysqlclient", "pymysql", "mysql-connector-python"]\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nStandardizing on PostgreSQL reduces operational complexity and enables advanced features like JSONB, full-text search, and pgvector for AI applications."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Database standardization"}),"\n",(0,r.jsx)(n.li,{children:"Reducing operational overhead"}),"\n",(0,r.jsx)(n.li,{children:"Enabling advanced PostgreSQL features"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Customization"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Allow MySQL only for legacy migration projects\npermit(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.dependency in ["mysql", "mysql2"] &&\n  resource.project.tags.contains("legacy-migration") &&\n  resource.migration_deadline > context.now\n};\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-no-momentjs",children:"2. No Moment.js"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "Use date-fns or dayjs instead of moment.js - moment is deprecated"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: no-moment\n// Scope: company\n// Severity: error\n// Reference: https://momentjs.com/docs/#/-project-status/\n\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.dependency == "moment" ||\n  resource.dependency.startsWith("moment-")\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nMoment.js is in maintenance mode and not recommended for new projects. It's also very large (300KB+) and mutable. Modern alternatives like date-fns are tree-shakeable and immutable."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reducing bundle size"}),"\n",(0,r.jsx)(n.li,{children:"Using maintained libraries"}),"\n",(0,r.jsx)(n.li,{children:"Modernizing date handling"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Migration Guide"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Before (moment)\nmoment().add(7, 'days').format('YYYY-MM-DD')\n\n// After (date-fns)\nimport { addDays, format } from 'date-fns'\nformat(addDays(new Date(), 7), 'yyyy-MM-dd')\n\n// After (dayjs)\nimport dayjs from 'dayjs'\ndayjs().add(7, 'day').format('YYYY-MM-DD')\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Customization"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Grace period for existing projects\npermit(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.dependency == "moment" &&\n  resource.project.created_before < "2023-01-01" &&\n  resource.migration_planned == true\n};\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-no-full-lodash",children:"3. No Full Lodash"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "Use lodash-es or individual lodash functions, not the full bundle"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: no-lodash-full\n// Scope: org\n// Severity: warn\n\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.dependency == "lodash" &&\n  !resource.import_style == "cherry-pick"\n}\nadvice {\n  message: "Use \'lodash-es\' or individual imports like \'lodash/debounce\' for better tree-shaking"\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nThe full lodash bundle is 70KB+ minified. Using lodash-es or cherry-picked imports enables tree-shaking and dramatically reduces bundle size."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Frontend bundle optimization"}),"\n",(0,r.jsx)(n.li,{children:"Performance improvement"}),"\n",(0,r.jsx)(n.li,{children:"Build time reduction"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Allowed Patterns"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 Good: Individual imports\nimport debounce from 'lodash/debounce'\nimport { debounce } from 'lodash-es'\n\n// \u274c Bad: Full bundle\nimport _ from 'lodash'\nimport { debounce } from 'lodash'  // Still imports full bundle!\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-require-opentelemetry",children:"4. Require OpenTelemetry"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "All services must include OpenTelemetry for distributed tracing"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: require-opentelemetry\n// Scope: org (Platform Engineering)\n// Severity: warn\n\nforbid(\n  principal,\n  action == Action::"Deploy",\n  resource\n)\nwhen {\n  resource.type == "service" &&\n  !resource.dependencies.any(dep => \n    dep.name.contains("opentelemetry") ||\n    dep.name.contains("otel")\n  )\n}\nadvice {\n  message: "Add opentelemetry-sdk to enable distributed tracing. See: docs/observability/tracing.md"\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nDistributed tracing is essential for debugging microservices. OpenTelemetry provides vendor-neutral instrumentation."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Microservices observability"}),"\n",(0,r.jsx)(n.li,{children:"Performance debugging"}),"\n",(0,r.jsx)(n.li,{children:"Incident response"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Implementation Example"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'// Rust: Add to Cargo.toml\n[dependencies]\nopentelemetry = "0.21"\nopentelemetry-otlp = "0.14"\ntracing-opentelemetry = "0.22"\n\n// TypeScript: Add to package.json\n"@opentelemetry/api": "^1.7.0",\n"@opentelemetry/sdk-node": "^0.45.0",\n"@opentelemetry/auto-instrumentations-node": "^0.39.0"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-no-deprecated-dependencies",children:"5. No Deprecated Dependencies"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "Block packages that are officially deprecated or unmaintained"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: no-deprecated-deps\n// Scope: company\n// Severity: error\n\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.dependency in [\n    "request",           // Deprecated 2020\n    "node-uuid",         // Use \'uuid\' instead\n    "istanbul",          // Use \'nyc\' instead\n    "coffee-script",     // Deprecated\n    "tslint",            // Use eslint instead\n    "node-sass",         // Use sass (dart-sass)\n    "faker",             // Compromised, use @faker-js/faker\n    "colors",            // Compromised\n    "left-pad"           // Historical, use String.padStart\n  ]\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nDeprecated packages don't receive security updates and may have known vulnerabilities. Using maintained alternatives ensures security and compatibility."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Security compliance"}),"\n",(0,r.jsx)(n.li,{children:"Supply chain security"}),"\n",(0,r.jsx)(n.li,{children:"Technical debt prevention"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Migration Mapping"}),":"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Deprecated"}),(0,r.jsx)(n.th,{children:"Replacement"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"request"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"node-fetch"}),", ",(0,r.jsx)(n.code,{children:"axios"}),", ",(0,r.jsx)(n.code,{children:"got"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"node-uuid"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"uuid"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"istanbul"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"nyc"})," or ",(0,r.jsx)(n.code,{children:"c8"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tslint"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"eslint"})," + ",(0,r.jsx)(n.code,{children:"@typescript-eslint"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"node-sass"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"sass"})," (dart-sass)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"faker"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@faker-js/faker"})})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-require-security-updates",children:"6. Require Security Updates"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "Dependencies with known vulnerabilities must be updated within 30 days"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: require-security-updates\n// Scope: company\n// Severity: block (critical), error (high), warn (medium)\n\nforbid(\n  principal,\n  action == Action::"Deploy",\n  resource\n)\nwhen {\n  resource.vulnerabilities.any(vuln =>\n    vuln.severity == "critical" &&\n    vuln.discovered_days_ago > 7\n  )\n};\n\nforbid(\n  principal,\n  action == Action::"Deploy",\n  resource\n)\nwhen {\n  resource.vulnerabilities.any(vuln =>\n    vuln.severity == "high" &&\n    vuln.discovered_days_ago > 14\n  )\n};\n\nforbid(\n  principal,\n  action == Action::"Deploy",\n  resource\n)\nwhen {\n  resource.vulnerabilities.any(vuln =>\n    vuln.severity == "medium" &&\n    vuln.discovered_days_ago > 30\n  )\n}\nadvice {\n  message: "Run \'npm audit fix\' or \'cargo audit fix\' to resolve vulnerabilities"\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nTimely patching of security vulnerabilities is essential for maintaining security posture. This policy enforces SLAs based on severity."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"SOC2 compliance"}),"\n",(0,r.jsx)(n.li,{children:"Security SLAs"}),"\n",(0,r.jsx)(n.li,{children:"Risk management"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Customization"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Extended deadline for complex updates requiring testing\npermit(\n  principal,\n  action == Action::"Deploy",\n  resource\n)\nwhen {\n  resource.vulnerabilities.all(vuln =>\n    vuln.exception_approved == true &&\n    vuln.exception_reason != "" &&\n    vuln.exception_expires > context.now\n  )\n};\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-pin-major-versions",children:"7. Pin Major Versions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "No floating major versions - all dependencies must have pinned major version"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: pin-major-versions\n// Scope: org\n// Severity: error\n\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.file == "package.json" &&\n  resource.content.matches("\\"[*x]\\"") ||\n  resource.content.matches("\\">=[0-9]\\"") ||\n  resource.content.matches("\\"latest\\"")\n};\n\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.file == "Cargo.toml" &&\n  resource.content.matches("\\"\\\\*\\"")\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nFloating major versions can introduce breaking changes unexpectedly. Pinning at least the major version ensures reproducible builds."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Build reproducibility"}),"\n",(0,r.jsx)(n.li,{children:"Preventing surprise breakages"}),"\n",(0,r.jsx)(n.li,{children:"CI/CD stability"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Allowed Patterns"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "dependencies": {\n    "react": "^18.2.0",    // \u2705 Good: Caret allows minor/patch\n    "lodash": "~4.17.21",  // \u2705 Good: Tilde allows patch only\n    "axios": "1.6.0",      // \u2705 Good: Exact version\n    "express": "*",        // \u274c Bad: Floating\n    "moment": "latest"     // \u274c Bad: Latest tag\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"8-no-install-scripts",children:"8. No Install Scripts"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "Block packages that run arbitrary scripts during installation"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: no-install-scripts\n// Scope: company\n// Severity: warn\n\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.has_install_scripts == true &&\n  !resource.dependency in context.allowed_install_scripts\n}\nadvice {\n  message: "Package runs scripts during install. Review security implications or use --ignore-scripts"\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nInstall scripts (postinstall, preinstall) can execute arbitrary code during ",(0,r.jsx)(n.code,{children:"npm install"}),". This is a supply chain attack vector."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Supply chain security"}),"\n",(0,r.jsx)(n.li,{children:"CI/CD hardening"}),"\n",(0,r.jsx)(n.li,{children:"Preventing malicious code execution"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Mitigation"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Disable install scripts globally\nnpm config set ignore-scripts true\n\n# Or per-install\nnpm install --ignore-scripts\n\n# Then explicitly run trusted scripts\nnpm rebuild\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Customization"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Allowlist for trusted packages that need install scripts\npermit(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.has_install_scripts == true &&\n  resource.dependency in [\n    "esbuild",      // Native binary download\n    "sharp",        // Image processing native deps\n    "sqlite3",      // Native compilation\n    "@prisma/client" // Prisma engine download\n  ]\n};\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"9-require-license-check",children:"9. Require License Check"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "Only allow dependencies with approved open source licenses"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: require-license-check\n// Scope: company\n// Severity: block\n\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  !resource.license in [\n    "MIT",\n    "Apache-2.0", \n    "BSD-2-Clause",\n    "BSD-3-Clause",\n    "ISC",\n    "0BSD",\n    "Unlicense",\n    "CC0-1.0",\n    "MPL-2.0"      // Weak copyleft, generally OK\n  ]\n}\nadvice {\n  message: "License not in approved list. Contact legal@company.com for approval."\n};\n\n// Explicitly block strong copyleft for proprietary products\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.license in ["GPL-2.0", "GPL-3.0", "AGPL-3.0", "LGPL-3.0"] &&\n  resource.project.distribution == "proprietary"\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nLicense compliance is essential for legal protection. Some licenses (GPL, AGPL) have copyleft requirements that may conflict with proprietary software."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Legal compliance"}),"\n",(0,r.jsx)(n.li,{children:"Open source governance"}),"\n",(0,r.jsx)(n.li,{children:"Risk management"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"License Categories"}),":"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Category"}),(0,r.jsx)(n.th,{children:"Licenses"}),(0,r.jsx)(n.th,{children:"Typical Use"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Permissive"}),(0,r.jsx)(n.td,{children:"MIT, Apache-2.0, BSD"}),(0,r.jsx)(n.td,{children:"\u2705 All uses"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Weak Copyleft"}),(0,r.jsx)(n.td,{children:"LGPL, MPL"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Usually OK, check"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Strong Copyleft"}),(0,r.jsx)(n.td,{children:"GPL, AGPL"}),(0,r.jsx)(n.td,{children:"\u274c Review with legal"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Unknown"}),(0,r.jsx)(n.td,{children:"No license"}),(0,r.jsx)(n.td,{children:"\u274c Avoid"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"10-max-bundle-size",children:"10. Max Bundle Size"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Natural Language"}),': "No single dependency should add more than 100KB to the bundle"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cedar",children:'// Policy: max-bundle-size\n// Scope: team (Frontend)\n// Severity: warn\n\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.bundle_size_kb > 100 &&\n  resource.project.type == "frontend"\n}\nadvice {\n  message: "Dependency adds {resource.bundle_size_kb}KB to bundle. Consider alternatives or lazy loading."\n};\n\n// Hard block for extremely large dependencies\nforbid(\n  principal,\n  action == Action::"UseDependency",\n  resource\n)\nwhen {\n  resource.bundle_size_kb > 500 &&\n  resource.project.type == "frontend"\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":\nLarge dependencies hurt page load performance. Monitoring bundle size prevents performance regression."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Frontend performance"}),"\n",(0,r.jsx)(n.li,{children:"Mobile optimization"}),"\n",(0,r.jsx)(n.li,{children:"Core Web Vitals"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tools for Analysis"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Analyze bundle impact before adding\nnpx bundle-phobia-cli lodash\n\n# Visualize current bundle\nnpx webpack-bundle-analyzer\n\n# Check size during development\nnpm install --save-dev size-limit\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Large Dependency Alternatives"}),":"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Heavy"}),(0,r.jsx)(n.th,{children:"Size"}),(0,r.jsx)(n.th,{children:"Lighter Alternative"}),(0,r.jsx)(n.th,{children:"Size"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"moment"}),(0,r.jsx)(n.td,{children:"300KB"}),(0,r.jsx)(n.td,{children:"date-fns"}),(0,r.jsx)(n.td,{children:"30KB"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"lodash"}),(0,r.jsx)(n.td,{children:"70KB"}),(0,r.jsx)(n.td,{children:"lodash-es (tree-shake)"}),(0,r.jsx)(n.td,{children:"10KB"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"chart.js"}),(0,r.jsx)(n.td,{children:"200KB"}),(0,r.jsx)(n.td,{children:"lightweight-charts"}),(0,r.jsx)(n.td,{children:"40KB"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"aws-sdk"}),(0,r.jsx)(n.td,{children:"3MB+"}),(0,r.jsx)(n.td,{children:"@aws-sdk/client-*"}),(0,r.jsx)(n.td,{children:"varies"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"implementation-checklist",children:"Implementation Checklist"}),"\n",(0,r.jsx)(n.p,{children:"To implement dependency management policies:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Audit current dependencies"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ aeterna policy simulate dependency-management --scope org\n\nSimulation Results:\n  Projects scanned: 47\n  Violations found: 23\n    - 8 using moment.js\n    - 5 using full lodash\n    - 3 missing opentelemetry\n    - 7 with floating versions\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Plan migration timeline"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ aeterna policy create migration-plan \\\n    --violations 23 \\\n    --deadline 90d\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Deploy as warnings first"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ aeterna policy import dependency-management.md \\\n    --scope org \\\n    --severity warn\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Track remediation progress"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ aeterna govern audit --type dependency_violation --trend 30d\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Escalate severity"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# After 30 days\n$ aeterna policy update no-moment --severity error\n\n# After 60 days  \n$ aeterna policy update no-moment --severity block\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"related-policies",children:"Related Policies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/aeterna/docs/examples/policies/security-baseline",children:"Security Baseline"})," - Core security policies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/aeterna/docs/examples/policies/architecture-constraints",children:"Architecture Constraints"})," - Enforce patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/aeterna/docs/examples/policies/code-quality",children:"Code Quality"})," - Maintain standards"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453(e,n,s){s.d(n,{R:()=>c,x:()=>d});var i=s(6540);const r={},l=i.createContext(r);function c(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);