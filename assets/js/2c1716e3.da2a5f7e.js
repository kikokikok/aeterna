"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[5499],{9666(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"cca/architecture","title":"CCA Architecture","description":"Hybrid Execution Model","source":"@site/docs/cca/architecture.md","sourceDirName":"cca","slug":"/cca/architecture","permalink":"/aeterna/docs/cca/architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/cca/architecture.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"CCA: Confucius Code Agent Capabilities","permalink":"/aeterna/docs/cca/overview"},"next":{"title":"CCA Configuration","permalink":"/aeterna/docs/cca/configuration"}}');var i=t(4848),s=t(8453);const o={},a="CCA Architecture",l={},c=[{value:"Hybrid Execution Model",id:"hybrid-execution-model",level:2},{value:"Data Flow Examples",id:"data-flow-examples",level:2},{value:"1. Context Assembly Request",id:"1-context-assembly-request",level:3},{value:"2. Trajectory Capture Flow",id:"2-trajectory-capture-flow",level:3},{value:"3. Hindsight Error Resolution",id:"3-hindsight-error-resolution",level:3},{value:"4. Meta-Agent Build-Test-Improve Loop",id:"4-meta-agent-build-test-improve-loop",level:3},{value:"Component Interactions",id:"component-interactions",level:2},{value:"Context Architect + Memory Layers",id:"context-architect--memory-layers",level:3},{value:"Note-Taking + Context Architect",id:"note-taking--context-architect",level:3},{value:"Hindsight + Note-Taking",id:"hindsight--note-taking",level:3},{value:"Meta-Agent + All Components",id:"meta-agent--all-components",level:3},{value:"Deployment Considerations",id:"deployment-considerations",level:2},{value:"Client-Side Extensions",id:"client-side-extensions",level:3},{value:"Server-Side Agents",id:"server-side-agents",level:3},{value:"Performance Tuning",id:"performance-tuning",level:3},{value:"Monitoring",id:"monitoring",level:3},{value:"Security Considerations",id:"security-considerations",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"cca-architecture",children:"CCA Architecture"})}),"\n",(0,i.jsx)(n.h2,{id:"hybrid-execution-model",children:"Hybrid Execution Model"}),"\n",(0,i.jsx)(n.p,{children:"CCA capabilities operate across two distinct execution contexts: client-side extensions (OpenCode Plugin) and server-side agents (Aeterna Core). This hybrid architecture enables low-latency local processing while leveraging centralized memory storage and compute."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          CLIENT SIDE (OpenCode Plugin)                       \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                         Extension System                                \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502 \u2502\n\u2502  \u2502  \u2502 Extension A  \u2502  \u2502 Extension B  \u2502  \u2502 Extension C  \u2502  \u2502 Extension N  \u2502\u2502 \u2502\n\u2502  \u2502  \u2502              \u2502  \u2502              \u2502  \u2502              \u2502  \u2502              \u2502\u2502 \u2502\n\u2502  \u2502  \u2502 \u2022 Callbacks  \u2502  \u2502 \u2022 Callbacks  \u2502  \u2502 \u2022 Callbacks  \u2502  \u2502 \u2022 Callbacks  \u2502\u2502 \u2502\n\u2502  \u2502  \u2502 \u2022 State (1MB)\u2502  \u2502 \u2022 State (1MB)\u2502  \u2502 \u2022 State (1MB)\u2502  \u2502 \u2022 State (1MB)\u2502\u2502 \u2502\n\u2502  \u2502  \u2502 \u2022 Priority 1 \u2502  \u2502 \u2022 Priority 2 \u2502  \u2502 \u2022 Priority 5 \u2502  \u2502 \u2022 Priority 10\u2502\u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Execution Order: Priority DESC (N \u2192 C \u2192 B \u2192 A)                         \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                    Extension Registry & Executor                        \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  \u2022 ExtensionRegistration: id, callbacks, prompt_additions, tool_config \u2502 \u2502\n\u2502  \u2502  \u2022 ExtensionExecutor: orchestrates callback chains                      \u2502 \u2502\n\u2502  \u2502  \u2022 ExtensionStateStore: Redis-backed persistence (zstd compression)    \u2502 \u2502\n\u2502  \u2502  \u2022 ExtensionStateLimiter: LRU eviction, 1MB per extension              \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                         Callback Hooks                                  \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  1. on_input_messages(messages)  \u2192  Transform user/system messages     \u2502 \u2502\n\u2502  \u2502  2. on_plain_text(text)           \u2192  Process text before parsing       \u2502 \u2502\n\u2502  \u2502  3. on_tag(tag, content)          \u2192  Handle custom tags                \u2502 \u2502\n\u2502  \u2502  4. on_llm_output(output)         \u2192  Post-process LLM responses        \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Each callback:                                                          \u2502 \u2502\n\u2502  \u2502  \u2022 Receives ExtensionContext (tenant, session, tools, state)           \u2502 \u2502\n\u2502  \u2502  \u2022 Timeout: 5s default (configurable)                                   \u2502 \u2502\n\u2502  \u2502  \u2022 Chained in priority order                                            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                              \u2502\n\u2502                                      \u25b2                                       \u2502\n\u2502                                      \u2502 MCP Tools API                         \u2502\n\u2502                                      \u25bc                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                       \u2502\n                                       \u2502 HTTP/JSON-RPC\n                                       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         SERVER SIDE (Aeterna Core)                           \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                          Context Architect                              \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502  \u2502          Hierarchical Context Assembly Pipeline                  \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Query  \u2192  Parallel Layer Retrieval  \u2192  Relevance Scoring  \u2192   \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Deduplication  \u2192  Token Budget Fitting  \u2192  Context Summary     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Memory Layers (queried in parallel if enabled):                        \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502 \u2502\n\u2502  \u2502  \u2502 Agent  \u2502  \u2502  User  \u2502  \u2502Session \u2502  \u2502Project \u2502  \u2502  Team  \u2502 ...       \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518           \u2502 \u2502\n\u2502  \u2502      \u2502           \u2502           \u2502           \u2502           \u2502                  \u2502 \u2502\n\u2502  \u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2502 \u2502\n\u2502  \u2502                              \u2502                                           \u2502 \u2502\n\u2502  \u2502                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                               \u2502 \u2502\n\u2502  \u2502                    \u2502  Token Budget Mgr  \u2502                               \u2502 \u2502\n\u2502  \u2502                    \u2502  \u2022 Min relevance   \u2502                               \u2502 \u2502\n\u2502  \u2502                    \u2502  \u2022 Early term.     \u2502                               \u2502 \u2502\n\u2502  \u2502                    \u2502  \u2022 Cache (300s TTL)\u2502                               \u2502 \u2502\n\u2502  \u2502                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                               \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Output: AssembledContext { total_tokens, content, layers_included }   \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                          Note-Taking Agent                              \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502  \u2502           Trajectory Capture & Distillation Pipeline              \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Tool Call  \u2192  Event Capture  \u2192  Async Queue  \u2192  Batch Write  \u2192 \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Accumulate (Threshold)  \u2192  Distill to Markdown  \u2192  Store as    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                     Memory         \u2502  \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Capture Modes:                                                          \u2502 \u2502\n\u2502  \u2502  \u2022 All: Capture every event                                             \u2502 \u2502\n\u2502  \u2502  \u2022 Sampled: Capture 1 in N events (configurable rate)                  \u2502 \u2502\n\u2502  \u2502  \u2022 ErrorsOnly: Capture only failures                                    \u2502 \u2502\n\u2502  \u2502  \u2022 Disabled: No capture                                                 \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Queue Configuration:                                                    \u2502 \u2502\n\u2502  \u2502  \u2022 Size: 1000 events (default)                                          \u2502 \u2502\n\u2502  \u2502  \u2022 Batch: 10 events (default)                                           \u2502 \u2502\n\u2502  \u2502  \u2022 Flush: 100ms (default)                                               \u2502 \u2502\n\u2502  \u2502  \u2022 Overhead budget: 5ms per event                                       \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Output: Distilled notes stored in Project/Team/Org memory layers      \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                         Hindsight Learning                              \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502  \u2502             Error Pattern Recognition Pipeline                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Error  \u2192  Signature Extract  \u2192  Semantic Search  \u2192  Match     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Resolution Ranking  \u2192  Promotion (if threshold met)  \u2192  Store  \u2502  \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Error Signature:                                                        \u2502 \u2502\n\u2502  \u2502  \u2022 error_type: "TypeError", "BuildError", etc.                          \u2502 \u2502\n\u2502  \u2502  \u2022 message_pattern: Regex or substring                                  \u2502 \u2502\n\u2502  \u2502  \u2022 context_patterns: Stack trace patterns, file paths                   \u2502 \u2502\n\u2502  \u2502  \u2022 embedding: Vector for semantic matching                              \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Resolution Tracking:                                                    \u2502 \u2502\n\u2502  \u2502  \u2022 description: What was done to fix                                    \u2502 \u2502\n\u2502  \u2502  \u2022 success_rate: % of times this resolution worked                      \u2502 \u2502\n\u2502  \u2502  \u2022 application_count: How many times applied                            \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Promotion: If success_rate >= 0.8, promote to broader layer           \u2502 \u2502\n\u2502  \u2502  Output: Matched resolutions with scores                                \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                             Meta-Agent                                  \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502  \u2502              Build-Test-Improve Loop (BTI)                        \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Iteration 1:                                                     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   BUILD (120s timeout)  \u2192  TEST (60s timeout)  \u2192  IMPROVE        \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Iteration 2:                                                     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   BUILD (refined)  \u2192  TEST  \u2192  IMPROVE                            \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502                                                                    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   Iteration N (max 3):                                             \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502   BUILD  \u2192  TEST  \u2192  Success? \u2192 Exit : (Escalate or Continue)    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Loop State Tracking:                                                    \u2502 \u2502\n\u2502  \u2502  \u2022 iterations: Current iteration count                                  \u2502 \u2502\n\u2502  \u2502  \u2022 last_build: Output, notes, tokens used                               \u2502 \u2502\n\u2502  \u2502  \u2022 last_test: Status, output, duration                                  \u2502 \u2502\n\u2502  \u2502  \u2022 last_improve: Action taken (retry, refine, escalate)                \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Integration:                                                            \u2502 \u2502\n\u2502  \u2502  \u2022 Queries Hindsight for error resolutions                              \u2502 \u2502\n\u2502  \u2502  \u2022 Captures trajectory via Note-Taking                                  \u2502 \u2502\n\u2502  \u2502  \u2022 Uses Context Architect for full context                              \u2502 \u2502\n\u2502  \u2502                                                                          \u2502 \u2502\n\u2502  \u2502  Output: Final build result or escalation signal                        \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                       \u2502\n                                       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                              Storage Layer                                    \u2502\n\u2502                                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502  \u2502 PostgreSQL \u2502  \u2502   Qdrant   \u2502  \u2502   Redis    \u2502  \u2502  DuckDB    \u2502            \u2502\n\u2502  \u2502            \u2502  \u2502            \u2502  \u2502            \u2502  \u2502            \u2502            \u2502\n\u2502  \u2502 \u2022 Metadata \u2502  \u2502 \u2022 Vectors  \u2502  \u2502 \u2022 Cache    \u2502  \u2502 \u2022 Graph    \u2502            \u2502\n\u2502  \u2502 \u2022 Policies \u2502  \u2502 \u2022 Semantic \u2502  \u2502 \u2022 State    \u2502  \u2502 \u2022 Relations\u2502            \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,i.jsx)(n.h2,{id:"data-flow-examples",children:"Data Flow Examples"}),"\n",(0,i.jsx)(n.h3,{id:"1-context-assembly-request",children:"1. Context Assembly Request"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'User Request\n    \u2502\n    \u25bc\n[OpenCode Plugin]\n    \u2502\n    \u251c\u2500 Extension Chain (on_input_messages)\n    \u2502  \u2514\u2500 Transform/enrich request\n    \u2502\n    \u25bc\nMCP Tool: context_assemble({ query, tokenBudget, layers })\n    \u2502\n    \u25bc\n[Aeterna Server]\n    \u2502\n    \u251c\u2500 Context Architect\n    \u2502  \u2502\n    \u2502  \u251c\u2500 Query Layer: Agent (parallel)\n    \u2502  \u251c\u2500 Query Layer: User (parallel)\n    \u2502  \u251c\u2500 Query Layer: Session (parallel)\n    \u2502  \u251c\u2500 Query Layer: Project (parallel)\n    \u2502  \u2514\u2500 Query Layer: Team (parallel)\n    \u2502\n    \u251c\u2500 Relevance Scoring\n    \u2502  \u2514\u2500 Filter < 0.3 threshold\n    \u2502\n    \u251c\u2500 Deduplication\n    \u2502  \u2514\u2500 Remove semantic duplicates\n    \u2502\n    \u251c\u2500 Token Budget Fitting\n    \u2502  \u2514\u2500 Prioritize by layer + recency\n    \u2502\n    \u25bc\nAssembledContext { totalTokens: 3847, content: "...", layers: [Agent, User, Session] }\n    \u2502\n    \u25bc\n[OpenCode Plugin]\n    \u2502\n    \u2514\u2500 Extension Chain (on_llm_output)\n       \u2514\u2500 Format/display to user\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-trajectory-capture-flow",children:"2. Trajectory Capture Flow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Agent executes tool_call("memory_search", {...})\n    \u2502\n    \u25bc\n[Note-Taking Agent]\n    \u2502\n    \u251c\u2500 Check capture_mode: All/Sampled/ErrorsOnly\n    \u2502  \u2514\u2500 If Sampled: Random(1-100) <= sampling_rate?\n    \u2502\n    \u251c\u2500 Create TrajectoryEvent {\n    \u2502     tool_name: "memory_search",\n    \u2502     description: "Search for auth patterns",\n    \u2502     success: true,\n    \u2502     duration_ms: 42,\n    \u2502     metadata: { tags: ["auth"] }\n    \u2502  }\n    \u2502\n    \u251c\u2500 Async Queue (non-blocking)\n    \u2502  \u2514\u2500 Buffer size: 1000 events\n    \u2502\n    \u25bc\nBatch Processor (every 100ms or 10 events)\n    \u2502\n    \u251c\u2500 Write to storage\n    \u2502\n    \u251c\u2500 Check auto_distill_threshold\n    \u2502  \u2514\u2500 If event_count >= 10:\n    \u2502\n    \u25bc\nDistill to Markdown\n    \u2502\n    \u251c\u2500 Group by tags/themes\n    \u251c\u2500 Extract patterns\n    \u251c\u2500 Format as sections\n    \u2502\n    \u25bc\nStore as Memory (Project layer)\n    \u2502\n    \u2514\u2500 Memory content: "## Auth Search Patterns\\n- Frequently search for JWT\\n- ..."\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-hindsight-error-resolution",children:"3. Hindsight Error Resolution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Build fails with error\n    \u2502\n    \u25bc\n[Hindsight Learning]\n    \u2502\n    \u251c\u2500 Auto-capture if enabled\n    \u2502\n    \u251c\u2500 Extract ErrorSignature {\n    \u2502     error_type: "BuildError",\n    \u2502     message_pattern: "cannot find symbol: class JwtValidator",\n    \u2502     context_patterns: ["src/auth/", "Java"]\n    \u2502  }\n    \u2502\n    \u251c\u2500 Generate embedding (vector)\n    \u2502\n    \u25bc\nQuery existing hindsight notes\n    \u2502\n    \u251c\u2500 Semantic search (threshold: 0.8)\n    \u2502\n    \u251c\u2500 Find matches:\n    \u2502  \u2514\u2500 Match { score: 0.92, note_id: "hs_42", resolution: {\n    \u2502       description: "Add import com.example.auth.JwtValidator",\n    \u2502       success_rate: 0.95,\n    \u2502       application_count: 12\n    \u2502     }}\n    \u2502\n    \u25bc\nReturn ranked resolutions to user/agent\n    \u2502\n    \u2514\u2500 Agent applies fix\n       \u2502\n       \u25bc\n       Success? \u2192 Update resolution (success_rate++)\n       \u2502\n       \u2514\u2500 If success_rate >= 0.8: Promote to Team/Org layer\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-meta-agent-build-test-improve-loop",children:"4. Meta-Agent Build-Test-Improve Loop"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'User: "Generate and test a user authentication module"\n    \u2502\n    \u25bc\n[Meta-Agent]\n    \u2502\n    \u251c\u2500 Iteration 1\n    \u2502  \u2502\n    \u2502  \u251c\u2500 BUILD (timeout: 120s)\n    \u2502  \u2502  \u251c\u2500 Query Context Architect for patterns\n    \u2502  \u2502  \u251c\u2500 Generate code\n    \u2502  \u2502  \u2514\u2500 Output: auth.rs (1247 tokens)\n    \u2502  \u2502\n    \u2502  \u251c\u2500 TEST (timeout: 60s)\n    \u2502  \u2502  \u251c\u2500 Run cargo test\n    \u2502  \u2502  \u2514\u2500 Status: FAILED (3 tests failed)\n    \u2502  \u2502\n    \u2502  \u2514\u2500 IMPROVE\n    \u2502     \u251c\u2500 Query Hindsight for similar errors\n    \u2502     \u251c\u2500 Capture trajectory via Note-Taking\n    \u2502     \u2514\u2500 Action: REFINE\n    \u2502\n    \u251c\u2500 Iteration 2\n    \u2502  \u2502\n    \u2502  \u251c\u2500 BUILD (refined)\n    \u2502  \u2502  \u2514\u2500 Apply hindsight resolutions\n    \u2502  \u2502\n    \u2502  \u251c\u2500 TEST\n    \u2502  \u2502  \u2514\u2500 Status: FAILED (1 test failed)\n    \u2502  \u2502\n    \u2502  \u2514\u2500 IMPROVE\n    \u2502     \u2514\u2500 Action: RETRY with different approach\n    \u2502\n    \u251c\u2500 Iteration 3\n    \u2502  \u2502\n    \u2502  \u251c\u2500 BUILD\n    \u2502  \u251c\u2500 TEST\n    \u2502  \u2502  \u2514\u2500 Status: SUCCESS\n    \u2502  \u2502\n    \u2502  \u2514\u2500 IMPROVE\n    \u2502     \u2514\u2500 Action: EXIT\n    \u2502\n    \u25bc\nReturn: { iterations: 3, status: "success", output: "All tests passed" }\n    \u2502\n    \u2514\u2500 Store successful trajectory as knowledge\n'})}),"\n",(0,i.jsx)(n.h2,{id:"component-interactions",children:"Component Interactions"}),"\n",(0,i.jsx)(n.h3,{id:"context-architect--memory-layers",children:"Context Architect + Memory Layers"}),"\n",(0,i.jsx)(n.p,{children:"The Context Architect queries memory layers based on configured priorities:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Default layer order: Session \u2192 Project \u2192 Team \u2192 Org \u2192 Company"}),"\n",(0,i.jsxs)(n.li,{children:["Parallel queries if ",(0,i.jsx)(n.code,{children:"enable_parallel_queries: true"})]}),"\n",(0,i.jsxs)(n.li,{children:["Early termination if ",(0,i.jsx)(n.code,{children:"enable_early_termination: true"})," and budget satisfied"]}),"\n",(0,i.jsx)(n.li,{children:"Cached results with TTL enforcement"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"note-taking--context-architect",children:"Note-Taking + Context Architect"}),"\n",(0,i.jsx)(n.p,{children:"Note-Taking stores distilled trajectories as memories, which Context Architect later retrieves:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Trajectory events accumulate (threshold: 10 events)"}),"\n",(0,i.jsx)(n.li,{children:"Distillation creates structured Markdown"}),"\n",(0,i.jsx)(n.li,{children:"Stored as Memory in Project/Team layer"}),"\n",(0,i.jsx)(n.li,{children:"Future context assemblies include these learnings"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"hindsight--note-taking",children:"Hindsight + Note-Taking"}),"\n",(0,i.jsx)(n.p,{children:"Hindsight captures errors, Note-Taking documents the resolution process:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Error occurs, Hindsight creates signature"}),"\n",(0,i.jsx)(n.li,{children:"Agent attempts fix, Note-Taking captures steps"}),"\n",(0,i.jsx)(n.li,{children:"Success triggers resolution creation"}),"\n",(0,i.jsx)(n.li,{children:"Resolution stored and ranked by success rate"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"meta-agent--all-components",children:"Meta-Agent + All Components"}),"\n",(0,i.jsx)(n.p,{children:"Meta-Agent orchestrates all other components in a feedback loop:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"BUILD: Uses Context Architect for full context"}),"\n",(0,i.jsx)(n.li,{children:"TEST: Captures results via Note-Taking"}),"\n",(0,i.jsx)(n.li,{children:"IMPROVE: Queries Hindsight for error resolutions"}),"\n",(0,i.jsx)(n.li,{children:"Next iteration: Enhanced context from previous learnings"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"deployment-considerations",children:"Deployment Considerations"}),"\n",(0,i.jsx)(n.h3,{id:"client-side-extensions",children:"Client-Side Extensions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Deployed as part of OpenCode plugin (npm package: ",(0,i.jsx)(n.code,{children:"@kiko-aeterna/opencode-plugin"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"State stored in Redis, compressed with zstd"}),"\n",(0,i.jsx)(n.li,{children:"LRU eviction when state exceeds 1MB per extension"}),"\n",(0,i.jsx)(n.li,{children:"Callback timeouts prevent hanging (default: 5s)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"server-side-agents",children:"Server-Side Agents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Deployed as Aeterna services (Rust binaries)"}),"\n",(0,i.jsx)(n.li,{children:"Horizontal scaling via shared PostgreSQL/Qdrant/Redis"}),"\n",(0,i.jsx)(n.li,{children:"Context Architect can be scaled independently (stateless queries)"}),"\n",(0,i.jsx)(n.li,{children:"Meta-Agent requires sticky sessions for loop state"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"performance-tuning",children:"Performance Tuning"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Enable parallel queries for low-latency context assembly"}),"\n",(0,i.jsx)(n.li,{children:"Adjust sampling rates for Note-Taking in high-throughput scenarios"}),"\n",(0,i.jsx)(n.li,{children:"Configure cache TTL based on memory update frequency"}),"\n",(0,i.jsx)(n.li,{children:"Set appropriate token budgets based on LLM context windows (e.g., 4000 for GPT-3.5, 16000 for GPT-4)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"monitoring",children:"Monitoring"}),"\n",(0,i.jsx)(n.p,{children:"Key metrics to track:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Context assembly latency (target: <100ms)"}),"\n",(0,i.jsx)(n.li,{children:"Note capture overhead (target: <5ms per event)"}),"\n",(0,i.jsx)(n.li,{children:"Hindsight query latency (target: <50ms)"}),"\n",(0,i.jsx)(n.li,{children:"Meta-Agent iteration counts (anomaly: >3 frequently)"}),"\n",(0,i.jsx)(n.li,{children:"Extension state size (alert: approaching 1MB)"}),"\n",(0,i.jsx)(n.li,{children:"Token budget utilization (track over/under budget scenarios)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Extension state may contain sensitive data - ensure Redis encryption at rest"}),"\n",(0,i.jsx)(n.li,{children:"Hindsight notes may leak error details - enable sensitive pattern detection"}),"\n",(0,i.jsx)(n.li,{children:"Context assembly should respect multi-tenant isolation (enforced at TenantContext level)"}),"\n",(0,i.jsx)(n.li,{children:"Meta-Agent iterations should have cumulative timeout to prevent runaway loops"}),"\n",(0,i.jsx)(n.li,{children:"Extension callbacks run in client context - validate all inputs from server responses"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>a});var r=t(6540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);