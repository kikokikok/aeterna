"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[9642],{8021(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"examples/policies/code-quality","title":"Code Quality Policies","description":"Maintain consistent code quality standards across your organization.","source":"@site/docs/examples/policies/code-quality.md","sourceDirName":"examples/policies","slug":"/examples/policies/code-quality","permalink":"/aeterna/docs/examples/policies/code-quality","draft":false,"unlisted":false,"editUrl":"https://github.com/kikokikok/aeterna/tree/main/website/docs/examples/policies/code-quality.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Security Baseline Policies","permalink":"/aeterna/docs/examples/policies/security-baseline"},"next":{"title":"Architecture Constraints Policies","permalink":"/aeterna/docs/examples/policies/architecture-constraints"}}');var i=r(4848),t=r(8453);const o={},c="Code Quality Policies",a={},l=[{value:"1. Require Tests",id:"1-require-tests",level:2},{value:"2. No Console Log",id:"2-no-console-log",level:2},{value:"3. Require JSDoc on Public APIs",id:"3-require-jsdoc-on-public-apis",level:2},{value:"4. No Any Type",id:"4-no-any-type",level:2},{value:"5. Require Error Handling",id:"5-require-error-handling",level:2},{value:"6. Max File Length",id:"6-max-file-length",level:2},{value:"7. Require Code Review",id:"7-require-code-review",level:2},{value:"Implementation Checklist",id:"implementation-checklist",level:2},{value:"ESLint Integration",id:"eslint-integration",level:2},{value:"Related Policies",id:"related-policies",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"code-quality-policies",children:"Code Quality Policies"})}),"\n",(0,i.jsx)(n.p,{children:"Maintain consistent code quality standards across your organization."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"1-require-tests",children:"1. Require Tests"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"}),': "All new code must have corresponding unit tests with minimum 80% coverage"']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Policy: require-tests\n// Scope: company\n// Severity: error\n\nforbid(\n  principal,\n  action == Action::"Merge",\n  resource\n)\nwhen {\n  resource.type == "pull_request" &&\n  resource.changed_files.any(file =>\n    file.path.matches(".*src/.*\\\\.(ts|js|rs)$") &&\n    !file.path.matches(".*(test|spec|mock).*")\n  ) &&\n  !resource.changed_files.any(file =>\n    file.path.matches(".*\\\\.(test|spec)\\\\.(ts|js|rs)$")\n  )\n}\nadvice {\n  message: "PR adds source files without corresponding tests. Add tests in __tests__/ or *.test.ts"\n};\n\n// Enforce coverage threshold\nforbid(\n  principal,\n  action == Action::"Merge",\n  resource\n)\nwhen {\n  resource.coverage_report.line_coverage < 80\n}\nadvice {\n  message: "Coverage is {resource.coverage_report.line_coverage}%. Minimum required: 80%"\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation"}),":\nTests catch bugs early, enable safe refactoring, and document expected behavior. 80% coverage balances thoroughness with practicality."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Quality assurance"}),"\n",(0,i.jsx)(n.li,{children:"Regression prevention"}),"\n",(0,i.jsx)(n.li,{children:"Safe refactoring"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Test File Naming"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"src/\n\u251c\u2500\u2500 user.service.ts\n\u251c\u2500\u2500 user.service.test.ts      # Unit tests (co-located)\n\u251c\u2500\u2500 __tests__/\n\u2502   \u2514\u2500\u2500 user.integration.ts   # Integration tests\n\u2514\u2500\u2500 __mocks__/\n    \u2514\u2500\u2500 user.repository.ts    # Mocks\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Customization"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Lower threshold for legacy code being migrated\npermit(\n  principal,\n  action == Action::"Merge",\n  resource\n)\nwhen {\n  resource.project.tags.contains("legacy-migration") &&\n  resource.coverage_report.line_coverage >= 60 &&\n  resource.coverage_increasing == true\n};\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-no-console-log",children:"2. No Console Log"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"}),': "Remove console.log statements before merging - use proper logging"']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Policy: no-console-log\n// Scope: org\n// Severity: error\n\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.path.matches(".*\\\\.(ts|js|tsx|jsx)$") &&\n  !resource.path.matches(".*(test|spec|mock|debug).*") &&\n  resource.content.matches("console\\\\.(log|debug|info)\\\\(")\n}\nadvice {\n  message: "Use logger instead of console.log. Import from \'@/lib/logger\'"\n};\n\n// Allow console.error/warn (they\'re often intentional)\npermit(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.content.matches("console\\\\.(error|warn)\\\\(") &&\n  !resource.content.matches("console\\\\.(log|debug|info)\\\\(")\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation"}),":\nConsole statements pollute logs, expose sensitive data, and indicate incomplete debugging. Production code should use structured logging."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Production readiness"}),"\n",(0,i.jsx)(n.li,{children:"Log hygiene"}),"\n",(0,i.jsx)(n.li,{children:"Security (preventing data leaks)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Proper Logging"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// \u274c Bad: Console statements\nconsole.log('User logged in:', user);\nconsole.log('Processing order', { orderId, items });\n\n// \u2705 Good: Structured logging\nimport { logger } from '@/lib/logger';\n\nlogger.info('User logged in', { userId: user.id });\nlogger.info('Processing order', { orderId, itemCount: items.length });\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Logger Setup"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// lib/logger.ts\nimport pino from 'pino';\n\nexport const logger = pino({\n  level: process.env.LOG_LEVEL || 'info',\n  formatters: {\n    level: (label) => ({ level: label }),\n  },\n  redact: ['password', 'token', 'secret'],  // Auto-redact sensitive fields\n});\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-require-jsdoc-on-public-apis",children:"3. Require JSDoc on Public APIs"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"}),': "All exported functions and classes must have JSDoc documentation"']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Policy: require-jsdoc-public\n// Scope: team\n// Severity: warn\n\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.path.matches(".*\\\\.(ts|js)$") &&\n  resource.exports.any(exp =>\n    exp.type in ["function", "class"] &&\n    !exp.has_jsdoc\n  )\n}\nadvice {\n  message: "Export \'{exp.name}\' is missing JSDoc. Add /** */ comment with description."\n};\n\n// Require examples for complex functions\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.exports.any(exp =>\n    exp.type == "function" &&\n    exp.param_count > 3 &&\n    !exp.jsdoc.has_example\n  )\n}\nadvice {\n  message: "Complex function \'{exp.name}\' should include @example in JSDoc"\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation"}),":\nDocumentation enables IDE support, auto-generated API docs, and faster onboarding. JSDoc is particularly valuable for TypeScript projects."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"API documentation"}),"\n",(0,i.jsx)(n.li,{children:"IDE integration"}),"\n",(0,i.jsx)(n.li,{children:"Developer experience"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"JSDoc Template"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"/**\n * Creates a new user account with the specified details.\n * \n * @param data - The user registration data\n * @param options - Optional configuration for user creation\n * @returns The created user object with generated ID\n * @throws {ValidationError} If email format is invalid\n * @throws {DuplicateError} If email already exists\n * \n * @example\n * ```typescript\n * const user = await createUser(\n *   { email: 'test@example.com', name: 'Test' },\n *   { sendWelcomeEmail: true }\n * );\n * console.log(user.id); // 'usr_abc123'\n * ```\n */\nexport async function createUser(\n  data: UserRegistration,\n  options?: CreateUserOptions\n): Promise<User> {\n  // Implementation\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-no-any-type",children:"4. No Any Type"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"}),": \"Avoid TypeScript 'any' type - use proper types or 'unknown'\""]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Policy: no-any-type\n// Scope: org\n// Severity: error\n\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.path.matches(".*\\\\.tsx?$") &&\n  !resource.path.matches(".*(test|spec|mock|\\\\.d\\\\.ts).*") &&\n  resource.content.matches(": any[^a-zA-Z]|<any>|as any")\n}\nadvice {\n  message: "Avoid \'any\' type. Use specific types, generics, or \'unknown\' with type guards."\n};\n\n// Also catch implicit any from tsconfig\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.file == "tsconfig.json" &&\n  resource.content.matches("\\"noImplicitAny\\":\\\\s*false")\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation"}),":\nThe ",(0,i.jsx)(n.code,{children:"any"})," type defeats TypeScript's purpose. It disables type checking and can hide bugs. Use ",(0,i.jsx)(n.code,{children:"unknown"})," with type guards for truly dynamic data."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Type safety"}),"\n",(0,i.jsx)(n.li,{children:"Bug prevention"}),"\n",(0,i.jsx)(n.li,{children:"Better IDE support"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Alternatives to Any"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// \u274c Bad: any\nfunction process(data: any) {\n  return data.value;  // No type checking!\n}\n\n// \u2705 Good: Specific type\nfunction process(data: { value: string }) {\n  return data.value;\n}\n\n// \u2705 Good: Generic\nfunction process<T extends { value: unknown }>(data: T) {\n  return data.value;\n}\n\n// \u2705 Good: unknown with type guard\nfunction process(data: unknown) {\n  if (isValidData(data)) {\n    return data.value;\n  }\n  throw new ValidationError('Invalid data');\n}\n\nfunction isValidData(data: unknown): data is { value: string } {\n  return typeof data === 'object' && data !== null && 'value' in data;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-require-error-handling",children:"5. Require Error Handling"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"}),': "No empty catch blocks - all errors must be handled or re-thrown"']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Policy: require-error-handling\n// Scope: company\n// Severity: error\n\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.path.matches(".*\\\\.(ts|js|rs)$") &&\n  resource.content.matches("catch\\\\s*\\\\([^)]*\\\\)\\\\s*\\\\{\\\\s*\\\\}")\n}\nadvice {\n  message: "Empty catch block detected. Handle the error, log it, or re-throw."\n};\n\n// Also check for swallowed errors (catch with no action)\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.catch_blocks.any(block =>\n    block.body.line_count == 0 ||\n    (block.body.line_count == 1 && block.body.matches("//.*ignore"))\n  )\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation"}),":\nEmpty catch blocks silently swallow errors, making debugging nearly impossible. Every error should be logged, handled, or re-thrown with context."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Debugging"}),"\n",(0,i.jsx)(n.li,{children:"Error visibility"}),"\n",(0,i.jsx)(n.li,{children:"Reliability"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Proper Error Handling"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// \u274c Bad: Swallowed error\ntry {\n  await riskyOperation();\n} catch (e) {\n  // Silent failure - impossible to debug\n}\n\n// \u274c Bad: Logged but not handled\ntry {\n  await riskyOperation();\n} catch (e) {\n  console.log(e);  // Logs but doesn't handle\n}\n\n// \u2705 Good: Proper handling\ntry {\n  await riskyOperation();\n} catch (e) {\n  logger.error('Risky operation failed', { error: e, context });\n  throw new OperationError('Failed to complete operation', { cause: e });\n}\n\n// \u2705 Good: Graceful degradation\ntry {\n  data = await fetchFromPrimary();\n} catch (e) {\n  logger.warn('Primary fetch failed, using fallback', { error: e });\n  data = await fetchFromFallback();\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"6-max-file-length",children:"6. Max File Length"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"}),': "Files should not exceed 500 lines - split into modules"']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Policy: max-file-length\n// Scope: team\n// Severity: warn\n\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.line_count > 500 &&\n  !resource.path.matches(".*(test|spec|mock|\\\\.generated\\\\.).*")\n}\nadvice {\n  message: "File is {resource.line_count} lines. Consider splitting into smaller modules."\n};\n\n// Stricter for specific file types\nforbid(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.path.matches(".*\\\\.(tsx|jsx)$") &&  // React components\n  resource.line_count > 300\n}\nadvice {\n  message: "Component file exceeds 300 lines. Extract sub-components or hooks."\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation"}),":\nLarge files are hard to navigate, understand, and maintain. They often indicate that a module has too many responsibilities."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Code organization"}),"\n",(0,i.jsx)(n.li,{children:"Maintainability"}),"\n",(0,i.jsx)(n.li,{children:"Collaboration (reduce merge conflicts)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Splitting Strategies"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"// Before: 800-line user.service.ts\nsrc/\n\u2514\u2500\u2500 user.service.ts\n\n// After: Split by responsibility\nsrc/\n\u251c\u2500\u2500 user/\n\u2502   \u251c\u2500\u2500 index.ts           # Public exports\n\u2502   \u251c\u2500\u2500 user.types.ts      # Type definitions\n\u2502   \u251c\u2500\u2500 user.service.ts    # Core CRUD operations\n\u2502   \u251c\u2500\u2500 user.auth.ts       # Authentication logic\n\u2502   \u251c\u2500\u2500 user.validation.ts # Validation rules\n\u2502   \u2514\u2500\u2500 user.notifications.ts # Email/SMS logic\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Customization"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Allow longer files for specific patterns\npermit(\n  principal,\n  action == Action::"Commit",\n  resource\n)\nwhen {\n  resource.line_count > 500 &&\n  (\n    resource.path.matches(".*\\\\.stories\\\\.tsx$") ||  // Storybook\n    resource.path.matches(".*schema\\\\.ts$") ||       // Schema definitions\n    resource.path.matches(".*constants\\\\.ts$")       // Constants files\n  )\n};\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"7-require-code-review",children:"7. Require Code Review"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"}),': "All PRs must have at least one approval from a team member"']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cedar Policy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Policy: require-code-review\n// Scope: company\n// Severity: block\n\nforbid(\n  principal,\n  action == Action::"Merge",\n  resource\n)\nwhen {\n  resource.type == "pull_request" &&\n  resource.approvals < 1\n}\nadvice {\n  message: "PR requires at least 1 approval before merging"\n};\n\n// Require 2 approvals for critical paths\nforbid(\n  principal,\n  action == Action::"Merge",\n  resource\n)\nwhen {\n  resource.type == "pull_request" &&\n  resource.changed_files.any(file =>\n    file.path.matches(".*(auth|security|payment|billing).*")\n  ) &&\n  resource.approvals < 2\n}\nadvice {\n  message: "Changes to critical paths require 2 approvals"\n};\n\n// Prevent self-approval\nforbid(\n  principal,\n  action == Action::"Approve",\n  resource\n)\nwhen {\n  resource.type == "pull_request" &&\n  resource.author == principal.id\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Explanation"}),":\nCode review catches bugs, shares knowledge, and maintains code quality. Critical paths (auth, payments) require additional scrutiny."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Quality assurance"}),"\n",(0,i.jsx)(n.li,{children:"Knowledge sharing"}),"\n",(0,i.jsx)(n.li,{children:"Compliance requirements"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Review Requirements by Path"}),":"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Path Pattern"}),(0,i.jsx)(n.th,{children:"Required Approvals"}),(0,i.jsx)(n.th,{children:"Reviewer Requirements"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"src/**"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Any team member"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"**/auth/**"})}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"At least 1 security champion"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"**/billing/**"})}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"At least 1 platform engineer"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"infrastructure/**"})}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"At least 1 DevOps engineer"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"**/migrations/**"})}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"At least 1 database owner"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Customization"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cedar",children:'// Allow single-person teams to merge without approval\npermit(\n  principal,\n  action == Action::"Merge",\n  resource\n)\nwhen {\n  resource.type == "pull_request" &&\n  resource.team.member_count == 1 &&\n  resource.ci_checks_passed == true\n};\n\n// Auto-approve bot PRs for dependency updates\npermit(\n  principal,\n  action == Action::"Merge",\n  resource\n)\nwhen {\n  resource.type == "pull_request" &&\n  resource.author in ["dependabot[bot]", "renovate[bot]"] &&\n  resource.ci_checks_passed == true &&\n  resource.changed_files.all(file =>\n    file.path.matches("(package\\\\.json|Cargo\\\\.toml|.*\\\\.lock)")\n  )\n};\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"implementation-checklist",children:"Implementation Checklist"}),"\n",(0,i.jsx)(n.p,{children:"To implement code quality policies:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configure tooling"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// package.json\n{\n  "scripts": {\n    "lint": "eslint src/",\n    "test": "jest --coverage",\n    "type-check": "tsc --noEmit"\n  }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Set up CI checks"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# .github/workflows/ci.yml\n- name: Lint\n  run: npm run lint\n\n- name: Type Check\n  run: npm run type-check\n\n- name: Test with Coverage\n  run: npm run test -- --coverageThreshold=\'{"global":{"lines":80}}\'\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configure branch protection"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ gh api repos/{owner}/{repo}/branches/main/protection -X PUT \\\n    -f required_pull_request_reviews.required_approving_review_count=1\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Import policies"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ aeterna policy import code-quality.md \\\n    --scope org \\\n    --mode enforce\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Track metrics"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ aeterna govern audit --type code_quality --trend 30d\n\nCode Quality Trends (30 days):\n  Coverage: 78% \u2192 85% (+7%)\n  Any types: 45 \u2192 12 (-73%)\n  Console logs: 23 \u2192 3 (-87%)\n  Empty catches: 8 \u2192 0 (-100%)\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"eslint-integration",children:"ESLint Integration"}),"\n",(0,i.jsx)(n.p,{children:"Many of these policies can be enforced via ESLint:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// .eslintrc.json\n{\n  "rules": {\n    "no-console": "error",\n    "@typescript-eslint/no-explicit-any": "error",\n    "no-empty": ["error", { "allowEmptyCatch": false }],\n    "jsdoc/require-jsdoc": ["warn", {\n      "require": {\n        "FunctionDeclaration": true,\n        "ClassDeclaration": true\n      },\n      "contexts": ["ExportNamedDeclaration"]\n    }],\n    "max-lines": ["warn", { "max": 500, "skipBlankLines": true }],\n    "max-lines-per-function": ["warn", { "max": 50 }]\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"related-policies",children:"Related Policies"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/aeterna/docs/examples/policies/security-baseline",children:"Security Baseline"})," - Core security policies"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/aeterna/docs/examples/policies/dependency-management",children:"Dependency Management"})," - Control packages"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/aeterna/docs/examples/policies/architecture-constraints",children:"Architecture Constraints"})," - Enforce patterns"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/aeterna/docs/examples/policies/team-conventions",children:"Team Conventions"})," - Team-specific rules"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>o,x:()=>c});var s=r(6540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);